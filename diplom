
СУПЕРПЛАН дипломной работы с комментариями
+++1. Введение
+++Что должно быть:
+++1.1 Обоснование актуальности темы — почему важно исследовать алгоритм определения ориентации по спутниковым сигналам сейчас. 
+++1.2 Формулировка цели работы — что именно вы хотите достичь, разработать или улучшить.
+++1.3 Основные задачи для достижения цели — конкретные шаги или этапы.
+++1.4 Определение объекта (что исследуется) и предмета (что именно рассматривается в объекте).
+++1.5 Используемые методы — какие подходы, модели, математические методы применялись.
+++1.6 Краткий обзор содержания — как структурирована работа.

Цель: Ввести читателя в тему, показать важность и направление исследования.

+++2. Обзор литературы и теоретические основы
+++Что должно быть:
+++2.1 Краткий исторический обзор развития спутниковой навигации.
+++2.2 Описание основных современных ГНСС (GPS, GLONASS, Galileo, BeiDou) — особенности и назначение.
+++2.3 Обзор существующих методов определения положения и ориентации объектов.
+++2.4 Подробности современных алгоритмов (матрицы, фильтры, методы наименьших квадратов и т.д.).
+++2.5 Критический анализ существующих решений, выявление их преимуществ и недостатков.
+++2.6. Сравнительный анализ методов
+++2.7. Перспективные и инновационные алгоритмы спутниковой навигации
+++2.8. Критика современных методов и перспектив
+++2.9. Перспективные технологии обработки спутниковых сигналов
+++2.10. Интеллектуальная обработка больших данных и самообучающиеся алгоритмы
+++2.11. Космическая квантовая и лазерная связь
+++2.12. Оценка внедрения новых технологий
+++2.13. Трансформация навигационных платформ: малые спутники и облачные системы
+++2.14. Заключительный критический анализ
+++2.15. Обоснование выбранного подхода
+++2.16. Пример применения алгоритма (сценарий: беспилотная морская платформа)
+++2.17. Междисциплинарное применение алгоритма
Цель: Показать владение теорией и существующими разработками, обосновать выбранный подход.

+++3. Теоретические основы алгоритма определения ориентации
+++Что должно быть:
+++3. ТЕОРЕТИЧЕСКИЕ ОСНОВЫ АЛГОРИТМА ОПРЕДЕЛЕНИЯ ОРИЕНТАЦИИ
+++3.1. МАТЕМАТИЧЕСКОЕ ОПИСАНИЕ СПУТНИКОВЫХ НАВИГАЦИОННЫХ СИГНАЛОВ
+++3.1.1. Модель принимаемого GNSS-сигнала
+++3.1.2. Временная задержка сигнала и доплеровский сдвиг
+++3.1.3. Псевдодальностные и фазовые измерения
+++3.1.4. Модели помех и шумов
+++3.2. ПОСТРОЕНИЕ МОДЕЛЬНЫХ УРАВНЕНИЙ ДЛЯ ОПРЕДЕЛЕНИЯ ОРИЕНТАЦИИ
+++3.2.1. Система навигационных уравнений позиционирования
+++3.2.2. Уравнения пространственной ориентации (углы Эйлера)
+++3.2.3. Матрица направляющих косинусов
+++3.2.4. Кватернионное представление ориентации объекта
+++3.3. ПРИМЕНЯЕМЫЕ МАТЕМАТИЧЕСКИЕ МЕТОДЫ И АЛГОРИТМЫ ОЦЕНКИ
+++3.3.1. Метод наименьших квадратов (МНК)
+++3.3.2. Классический фильтр Калмана
+++3.3.3. Расширенный фильтр Калмана (EKF)
+++3.3.4. Методы обработки разностей наблюдений
+++3.4. МОДЕЛИРОВАНИЕ ОШИБОК, УСТОЙЧИВОСТИ И НАБЛЮДАЕМОСТИ
+++3.4.1. Классификация систематических и случайных ошибок
+++3.4.2. Анализ наблюдаемости навигационной системы
+++3.4.3. Сценарии вычислительного эксперимента
+++3.4.4. Вектор состояния комплексной системы
+++3.4.5. Рекомендации по практической реализации
Цель: Показать глубокое понимание теории и ключевых математических инструментов, на базе которых будет строиться алгоритм.

4. Разработка и описание метода/алгоритма
Что должно быть:

Описание исходных данных и источников.
Определение структуры и логики алгоритма.
Детальные этапы работы алгоритма.
Математические выкладки, формулы, схемы.
Описание программной реализации (если есть), ее возможностей и ограничений.
Цель: Представить практическую реализацию научной идеи, показать, как теория превращается в конкретный инструмент.

+++4 РАЗРАБОТКА АЛГОРИТМА И ПРОГРАММНАЯ РЕАЛИЗАЦИЯ​
+++4.1 Архитектура и математическая постановка предлагаемого алгоритма​
+++4.1.1 Формулировка задачи комплексного позиционирования и определения ориентации​
+++4.1.2 Архитектура системы интеграции ГНСС/ИНС​
+++4.1.3 Математическая модель движения объекта​
+++4.1.4 Модель наблюдений ГНСС​
+++4.1.5 Расширенный фильтр Калмана: постановка и уравнения​
+++4.1.6 Структура алгоритма и реализация в цикле навигации​

+++4.2 Программная реализация алгоритма​
+++4.2.1 Выбор платформы, языков программирования и инструментов​
+++4.2.2 Архитектура программного комплекса​
+++4.2.3 Инициализация и конфигурация системы​
+++4.2.4 Реализация ключевых компонентов алгоритма (функции и классы)​
+++4.2.5 Параметризация и калибровка датчиков​

+++4.3 Вычислительные эксперименты и тестирование​
+++4.3.1 Сценарии моделирования и подготовка тестовых данных​
+++4.3.2 Метрики точности и показатели качества​
+++4.3.3 Результаты вычислительных экспериментов по сценариям​
+++4.3.4 Сравнение с базовыми подходами ГНСС и ИНС​
+++4.3.5 Графическая визуализация результатов (траектории, ошибки, инновации)​

+++4.4 Анализ полученных решений и практическая применяемость​
+++4.4.1 Обобщение результатов экспериментов и соответствие поставленным целям​
+++4.4.2 Анализ источников ошибок и ограничений алгоритма​
+++4.4.3 Практические рекомендации по внедрению и направления развития​
+++4.4.4 Область применимости разработанного алгоритма​
+++4.4.5 Выводы по разделу 4

5. Практическая реализация и моделирование
Что должно быть:

Описание модели исследования (например, тип объекта, сценарий работы).
Процесс проведения расчетов, тестирование алгоритма.
Анализ результатов в терминах точности, надежности, скорости.
Сравнение с существующими методами, обоснование преимуществ.
Цель: Доказать практическую ценность разработки и ее работоспособность.
6. Выводы и рекомендации
Что должно быть:

Краткое резюме выполненной работы.
Основные достижения и решения задачи.
Конкретные рекомендации по использованию алгоритма.
Возможные пути для дальнейшего развития и улучшения.
Цель: Итоговая оценка работы, предложения для практики и науки.

7. Список использованных источников
Что должно быть:
Полный список всех книг, статей, нормативных документов и ресурсов, которые были цитированы.
Оформление согласно стандартам вуза (ГОСТ или др.).
Цель: Подтвердить научную базу работы и обеспечить проверяемость.

8. Приложения
Что должно быть:
Код программ, если есть.
Расширенные таблицы, графики, иллюстрации.
Дополнительные материалы, которые не поместились в основной текст, но важны для понимания.
Цель: Дать читателю доступ к дополнительной технической информации.



1.Введение
1.1 Актуальность темы
В последние годы глобальные навигационные спутниковые системы (ГНСС) становятся неотъемлемым элементом инфраструктуры современного общества. Их интеграция в транспорт, логистику, робототехнику, авиацию и другие отрасли определяет новые требования к точности и надежности позиционирования, включая не только определение координат, но и ориентации объекта в пространстве. Классические навигационные решения, основанные на данных спутниковых систем, показывают высокую стабильность при определении местоположения, однако задачи пространственной ориентации требуют гораздо более сложного подхода, включающего обработку фазовых, временных и амплитудных параметров спутниковых сигналов, а также интеграцию с дополнительными датчиками и математическими моделями. Спутниковые навигационные системы, такие как GPS (США), GLONASS (Россия), Galileo (ЕС) и BeiDou (Китай), обеспечивают возможность точного определения положения объектов на Земле с метрической и даже сантиметровой точностью. Однако определение только координат недостаточно для многих задач: в авиации, космических аппаратах, беспилотных летательных аппаратах, робототехнике и судоходстве критически важно также знать пространственную ориентацию объекта — углы поворота по тангажу, крену и рысканию, которые позволяют адекватно управлять движением, стабилизацией и навигацией.
Разработка алгоритмов, способных вычислять пространственную ориентацию объектов только по сигналам навигационных спутников, становится особенно актуальной в условиях стремительного развития автономных транспортных систем, беспилотных летательных аппаратов, технических средств геодезии, морской и наземной робототехники. Мировой научно-технический прогресс и внедрение стандарта Industry 4.0 обусловили запрос на навигационные решения нового поколения, обладающие высокой точностью и устойчивостью к шумам, помехам и ошибкам измерения. Точность пространственной ориентации напрямую влияет на безопасность и эффективность функционирования сложных систем. Например, в авиации неправильная ориентация может привести к аварийным ситуациям, в робототехнике — к ошибкам в позиционировании и манипуляциях, в морском транспорте — к неточностям в курсовом управлении. Поэтому разработка надежных, быстрых и точных алгоритмов определения ориентации объектов по спутниковым сигналам является актуальной задачей, сочетающей математическую сложность, инженерные требования и современные вычислительные возможности.
Необходимость повышения автономности систем управления и навигации диктует создание сложных моделей обработки данных, которые способны не только локализовать объект, но и в режиме реального времени определять его пространственную ориентацию, исключая ошибки, вызванные влиянием внешних факторов. В целях обеспечения глобальной логистики, расширения возможностей диагностики и управления техническими объектами требуется фундаментальный пересмотр используемых подходов к обработке сигналов ГНСС. С увеличением требований к автономности и снижению зависимости от вспомогательных средств (например, гироскопов) возрастает интерес к методам чисто навигационного определения ориентации, что требует глубокого исследования свойств спутниковых сигналов, особенностей обработки многоканальных данных и разработки устойчивых алгоритмов. Отдельно стоит учитывать разнообразие факторов, ухудшающих качество сигналов: атмосферные условия, многолучевое распространение (отражения от зданий, рельефа), наличие помех, ошибки синхронизации. Все эти вызовы стимулируют развитие новых методик и решений.
Таким образом, тема разработки алгоритма определения пространственной ориентации объекта по сигналам навигационных спутников является не только актуальной, но и перспективной с точки зрения решения фундаментальных и прикладных задач современной науки и техники.​
1.2 Цель работы
Целью дипломной работы является разработка, обоснование и исследование алгоритма определения пространственной ориентации объекта на основе анализа сигналов глобальных навигационных спутниковых систем. Алгоритм должен отличаться высокой точностью, надежностью, устойчивостью к ошибкам измерения и возможностью реализации в аппаратных и программных комплексах различного уровня сложности.
Достижение заявленной цели предусматривает формализацию вычислительного подхода, адаптированного под реальные условия эксплуатации навигационных систем: влияние ошибок синхронизации, присутствие многолучевых эффектов, наличие шумов и аппаратных ограничений систем позиционирования.
Основная задача — обеспечить такой вычислительный алгоритм, который позволит вывести параметры угловой ориентации (тангаж, крен, рыскание) путем совместной обработки фазовых и временных характеристик поступающих спутниковых сигналов, а также обеспечить интеграцию с существующими навигационными и управляющими системами объекта.​
1.3 Задачи для достижения цели
Для реализации поставленной цели дипломной работы решаются следующие задачи:
    • Провести комплексный аналитический и библиографический обзор по теме глобальных навигационных спутниковых систем, а также современных методов позиционирования и определения угловой ориентации объектов.
    • Исследовать физико-математические принципы формирования спутниковых сигналов, рассмотреть возможности их интерпретации для задач пространственного анализа.
    • Сформулировать математическую модель, описывающую зависимость между параметрами спутниковых сигналов и ориентацией объекта, исходя из условий реальной эксплуатации навигационных средств.
    • Разработать алгоритм обработки спутниковых данных, позволяющий по результатам вычислений определить параметры ориентации с заданной точностью.
    • Реализовать программную модель построенного алгоритма, выполнить серию вычислительных экспериментов для определения точности и устойчивости полученных решений.
    • Провести сравнение с существующими алгоритмическими решениями, выявить основные преимущества, экономическую и техническую целесообразность внедрения предлагаемого вычислительного подхода.
    • Оформить научно-практические рекомендации по возможности применения построенного алгоритма в промышленных, транспортных и научных задачах.​
1.4 Объект и предмет исследования
Объектом исследования в данной работе выступают навигационные спутниковые системы, а также технические средства и программные комплексы, функционирующие на их основе в целях решения задач пространственной ориентации объектов.
Предмет исследования — алгоритмы и математические модели обработки сигналов глобальных навигационных спутниковых систем для определения параметров пространственной ориентации технических объектов, находящихся в условиях действия реальных эксплуатационных факторов.
В качестве примеров рассматриваются программно-аппаратные комплексы автономных транспортных платформ, беспилотных летательных аппаратов, робототехнических систем и специализированного геодезического оборудования.​
1.5 Используемые методы
В дипломной работе применяются современные методы математического моделирования, цифровой обработки сигналов, теории вероятностей и статистики, фильтрации и оценки погрешностей. Для достижения поставленной цели используются:
    • Методы анализа и обработки фазовых и временных характеристик сигналов ГНСС (метод наименьших квадратов, принцип максимального правдоподобия, фильтр Калмана).
    • Методы многоуровневой фильтрации данных, устойчивой к шумам и ошибкам измерения.
    • Математическое моделирование во временной и частотной областях.
    • Численные методы решения обратных задач ориентации и позиционирования.
    • Программная реализация расчетных алгоритмов на языках высокого уровня с использованием современных библиотек для навигационного анализа.
    • Верификация на моделях автономных и реальных технических объектов.
    • Сравнительный анализ результатов с традиционными и импортозамещающими решениями в области навигации.​
1.6 Краткий обзор содержания работы
Дипломная работа включает введение, три основные главы, заключение, список использованных источников и приложения. Во введении раскрываются актуальность, цели, задачи, методы и структура исследования.
В первой главе представлен детальный обзор литературы по глобальным спутниковым навигационным системам, а также теоретические и математические основы задачи пространственной ориентации. Вторая глава посвящена разработке алгоритма, анализу используемых моделей и реализации программного комплекса для обработки спутниковых сигналов. В третьей главе подробно описываются результаты экспериментов, тестирования, а также проводится сравнительный анализ точности и устойчивости построенного алгоритма с существующими подходами. В заключении подводятся итоги работы, формулируются научные и практические выводы, рекомендации по внедрению и направления дальнейших исследований.


2. Обзор литературы и теоретические основы
2.1. Краткий исторический обзор развития спутниковой навигации
Развитие спутниковых навигационных технологий — одно из ключевых достижений второй половины XX века, сформировавшее не только военную, но и социально-экономическую инфраструктуру современной цивилизации. Первые предпосылки к созданию глобальной системы позиционирования появились в годы «холодной войны», когда военным было необходимо определять положение войск, техники, морских и воздушных судов с высокой точностью в любых условиях и на любой точке земного шара.​
Изначально навигация строилась на радиопеленгации, однако этот подход был ограничен географическими рамками приёма и метеоусловий. Прорыв произошёл вслед за запуском первого спутника Земли — «Спутник-1» в 1957 г., который позволил советским учёным решить обратную задачу: по изменению частоты принятых с него сигналов за счёт эффекта Доплера вычислять координаты спутника и, соответственно, рассчитать собственные координаты станции приёма.​
Созданная в 1960-х годах система Transit (NAVSAT, США) стала первой спутниковой системой навигации, ориентированной на морские перевозки. Однако настоящее развитие началось с развертыванием NAVSTAR GPS (США) и ГЛОНАСС (СССР). Системы были ориентированы как на военных, так и на гражданских пользователей, а постепенное снятие искусственных ограничений открыло возможности для массового применения навигационных технологий в геодезии, транспорте, туризме, мобильных приложениях и научных исследованиях.​
Сегодня к числу глобальных навигационных спутниковых систем относят также европейскую Galileo (ЕС) и китайскую BeiDou, которые появились в 21 веке и были построены с учетом опыта эксплуатации GPS и ГЛОНАСС и современных вызовов, таких как надежность, помехоустойчивость, точность и доступность.​
2.2. Современные глобальные навигационные спутниковые системы (ГНСС)
Сравнительный анализ структуры и функций
Современные ГНСС предназначены для определения местоположения, скорости и времени для наземных, морских, воздушных и космических объектов. Каждая система состоит из трёх ключевых сегментов: космического (созвездие спутников), наземного (контрольные центры, станции слежения и синхронизации) и пользовательского (приемники разного уровня сложности и назначения).​
NAVSTAR GPS (США)
GPS (Global Positioning System) — первая в мире полностью развернутая спутниковая навигационная система, которая изначально предназначалась только для нужд военных США, но с 1983 года была открыта для гражданского использования. На сегодняшний день система состоит из 24-х активных спутников (и резервных), расположенных на шести орбитальных плоскостях. Высота орбиты составляет около 20 180 км, орбитальный период примерно 12 часов, что обеспечивает постоянную видимость как минимум четырёх спутников с любой точки земного шара.​
Каждый спутник GPS оснащен атомными часами, что обеспечивает требуемую синхронизацию. Передача информации идёт в L-диапазоне на двух частотах (L1 — 1575,42 МГц для гражданских и L2 — 1227,60 МГц для военных). Система обновляется и совершенствуется, новые спутники соответствуют требованиям по надежности, помехозащищенности и точности. Особая роль отводится наземной инфраструктуре — глобальной сети контрольных станций, обеспечивающих наблюдение за спутниками, обновление эфемерид, состояния и времени.​
ГЛОНАСС (Россия)
ГЛОНАСС — глобальная система навигации спутников, начала развёртывание в конце 1980-х, а к 2010 году обеспечила возможность глобального позиционирования. Отличается структурой орбитального созвездия: 24 спутника на трёх орбитальных плоскостях, высота орбиты 19 100 км, орбитальный период — 11 часов 15 минут. Система делает ставку на частотное разделение сигналов (FDMA и CDMA, начиная с новых спутников), что повышает помехоустойчивость и снижает взаимные наводки между спутниками. ГЛОНАСС функционирует как в военном, так и в гражданском сегменте, активно интегрируется с отечественной и зарубежной аппаратурой.​
Galileo (ЕС)
Galileo — крупный европейский проект, нацеленный на независимость ЕС от американской и российской инфраструктуры. Полноценная система предполагает функционирование 24 рабочих и 6 резервных спутников на трех орбитальных плоскостях, высота орбиты 23 222 км. Galileo использует схожие с GPS частоты для совместимости, а также уникальные каналы и сервисы: открытый, коммерческий, защищённый и сервис спасения SAR. Ключевые преимущества — обеспечения высокой точности, предоставление пользователю информации о надежности сигнала (integrity), улучшенная навигация в городских условиях.​
BeiDou (КНР)
Китайский BeiDou начал функционировать как региональная, а затем, с 2020 года, и как глобальная система. Имеет уникальную структуру: спутники на средневысотных, геостационарных и наклонных геостационарных орбитах. Помимо навигационных сервисов предоставляет функции передачи текстовых сообщений и высокоточной синхронизации времени. Преимущества BeiDou: высокая плотность покрытия в азиатско-тихоокеанском регионе, поддержка интеграции с международными системами, гибкость управления и широкий диапазон приложений.
2.3. Методы определения положения объектов с использованием спутниковой навигации
Современные методы определения положения объектов по сигналам ГНСС делятся на две основные группы: абсолютные и относительные. Абсолютные методы подразумевают самостоятельный расчет координат по сигналам от четырёх и более спутников, используя кодовую или фазовую информацию, а относительные — сравнивают результаты нескольких приемников, минимизируя ошибки распространения сигнала путем разностных измерений.​
Абсолютный метод
Абсолютный метод основан на вычислении псевдодальности — расстояния между спутником и приемником, с учётом ошибок времени и распространения сигнала. Узнать псевдодальность возможно по времени прохождения сигнала или фазе несущей частоты. Координаты спутника берутся из навигационного сообщения, а приемник решает систему уравнений, используя наблюдения от нескольких спутников, чтобы определить собственные параметры местоположения (x, y, z) и поправку к своим часам. Точность метода составляет от 3 до 15 метров, а при применении дополнительных технологий, таких как Precise Point Positioning (PPP), удаётся достичь субдециметровой точности, но для этого необходимы долгие наблюдения и многочастотные приемники.​
Метод применяется для мониторинга транспорта, судоходства, личной навигации, а также во многих массовых устройствах — смартфонах, автомобилях, портативных GPS-навигаторах.​
Относительный (дифференциальный) метод
Относительный метод реализуется с помощью пары или группы приемников: одна станция находится в точке с известными координатами (базовая), другая — в исследуемой точке (подвижная). Приемники синхронно получают сигналы от тех же спутников, и обработка разностных наблюдений позволяет устранить общие ошибки, связанные с задержками на распространение, ионосферными эффектами, ошибками эфемерид и др. Этот подход значительно увеличивает точность определения положения, достигая величин до миллиметра при фазовых измерениях по методу RTK (Real Time Kinematic).​
Метод распространён в геодезии, строительстве, научных исследованиях, требует специализированного оборудования и наличия доступа к корректирующей информации в реальном времени.​
Гибридные методы и технологии интеграции
Современная тенденция — применение комплексированных алгоритмов, сочетающих GNSS с инерциальными навигационными системами (IMU), магнитометрами и локальными сенсорами. Такой симбиоз позволяет существенно улучшить устойчивость и автономность позиционирования в условиях ограниченного сигнального покрытия (например, в городских каньонах, туннелях, густых лесах).​
Гибридные системы применяют многоканальную обработку сигналов, корреляцию с цифровыми моделями рельефа, программное фильтрование и интеллектуальную оценку ошибок, что обеспечивает качество навигации на порядки выше по сравнению с традиционными подходами.​
2.4. Методы определения пространственной ориентации объектов
Ориентация объекта (станции, платформы, судна, беспилотника) в пространстве — задача значительно более сложная, чем определение координат. Если координаты описываются в трёхмерном пространстве одной точкой, то ориентация требует определения углов поворота относительно нескольких изначальных осей.
Аппаратные методы
    • Мультиантенные GNSS-решения: несколько антенн, размещённых на фиксированном расстоянии на одной платформе, позволят по разности фаз принимать не только координаты, но и направление объекта. Полученная геометрическая информация используется для построения матрицы направляющих косинусов или кватернионов.
    • Интеграция с инерциальными датчиками и гироскопами: данная схема призвана компенсировать потери сигнала от спутников и вывести оценки ориентации даже в условиях шумов и кратковременных сигналов GNSS.​
Программные методы
    • Геометрический анализ разностей фаз: фазовые разности между сигналами от одной группы спутников, принятых разнесёнными антеннами, служат источником информации о повороте и ориентации платформы.
    • Матричные преобразования: вычисление матрицы перехода или кватерниона между локальной и глобальной системами координат, многомерная обработка наблюдаемой информации.
    • Фильтрация и оценка ориентации: применение фильтра Калмана, метода наименьших квадратов, байесовских фильтров для сглаживания временного ряда получаемых данных по ориентации и адаптации к локальным помехам.​
Современные тенденции в алгоритмах ориентации
Современные алгоритмы ориентации основаны на интеллектуальных моделях фильтрации, применении адаптивных и обучающихся систем. Особое внимание уделяется моделированию ошибок, многокомпонентной оценке параметров (совместная аппроксимация положения и поворота), отказоустойчивости платформы. Наиболее продвинутые решения используют алгоритмы машинного обучения для предикции поведения сенсоров и корректировки расчетов в реальном времени.​

2.4.1. Математическая модель спутникового сигнала GNSS 
Спутниковый сигнал GNSS представляет собой сложную структуру, включающую несущую волну, псевдослучайный код и навигационное сообщение. Общий вид принимаемого сигнала можно описать следующим уравнением:
s(t) = A * C(t - τ) * D(t - τ) * cos(2 π f_c (t - τ) + φ) + η(t)

    • A — амплитудa сигнала
    • C(t−τ) — псевдослучайная последовательность (например, C/A-код для GPS L1 или P(Y)-код для военного канала)
    • D(t−τ) — навигационное сообщение, содержащее эфемериды спутника и параметры времени
    • f_c — несущая частота (для GPS L1: 1575,42 МГц)
    • τ — временная задержка распространения сигнала от спутника до приемника
    • φ — начальная фаза
    • η(t) — аддитивный шум (белый гауссовский шум, помехи, многолучевость).
Фазовая задержка τ напрямую связана с расстоянием между спутником и приемником:
τ = R / c

τ = R / c

где R — истинное расстояние, c — скорость света.
Для определения пространственной ориентации используются разности фаз сигналов, принятых несколькими антеннами, расположенными на фиксированном базисе объекта. Разность фаз между двумя антеннами определяется как:


Δφ = {2 π} over {λ} * b * u
(λ — длина волны несущей частоты , vec{b} — вектор базиса между антеннами, vec{u} — единичный вектор направления на спутник)

2.4.2. Применение фильтра Калмана для оценки ориентации

Фильтр Калмана — оптимальный рекурсивный алгоритм оценки состояния динамической системы в условиях шумов измерений. Для задачи определения пространственной ориентации объекта по GNSS фильтр Калмана применяется следующим образом.

Прогноз состояния:
x_{k|k-1} = F * x_{k-1|k-1} + B * u_k


где  — предсказанное состояние (положение, скорость, ориентация), F  — матрица перехода состояния, B — матрица управления,  — вектор управления.

Прогноз ковариационной матрицы:
P_{k|k-1} = F * P_{k-1|k-1} * F^T + Q


где P  — ковариационная матрица ошибок, Q  — ковариация шума процесса.

Вычисление коэффициента усиления Калмана:
K_k = P_{k|k-1} * H^T * ( H * P_{k|k-1} * H^T + R )^{-1}


где H — матрица наблюдения, R  — ковариация шума измерений.

Обновление оценки:
x_{k|k} = x_{k|k-1} + K_k * ( y_k - H * x_{k|k-1} )


Обновление ковариационной матрицы:
P_{k|k} = ( I - K_k * H ) * P_{k|k-1}


Для представления ориентации объекта применяются кватернионы — четырёхмерные комплексные числа, избегающие проблемы "шарнирного замка" (gimbal lock). Обновление кватерниона во времени:
q_{t+1} = q_t odot quat(ω * Δt)


где q_t — текущий кватернион ориентации, ω — вектор угловой скорости, Δt — операция кватернионного умножения.

Применение фильтра Калмана с кватернионным представлением позволяет сглаживать шумы измерений и обеспечивать устойчивую оценку ориентации в реальном времени.

2.5. Современные алгоритмы обработки сигналов спутниковой навигации
Эффективная эксплуатация ГНСС невозможна без тщательной пространственно-временной обработки сигналов, поступающих на антенну приемника. Эти процедуры формируют фундамент современных алгоритмов позиционирования и ориентации, главным образом в высокоточных, промышленных навигационных системах. Алгоритмы всегда строятся на основе сложной обработки фильтрами, корреляторными схемами, а также на базе систем оценивания.​
Этапы обработки сигнала GNSS
    1. Синхронизация и захват кода — приемник распознает сигналы одноканально или по нескольким каналам, распаковывает псевдослучайный код. Методы кодовой корреляции обеспечивают устойчивость к шуму и позволяют отличать собственный сигнал от многолучевых отражений и других помех.​
    2. Определение временной задержки — измеряется время прихода сигнала от каждого спутника, что даёт основу для дальнейшего вычисления координат.
    3. Обработка фазовых характеристик — использование фазовой автоподстройки частоты (ФАПЧ) позволяет снизить ошибки при передаче и обработке данных, минимизируя фазовые различия между принятым и эталонным сигналом приемника. Это актуально для устойчивости при высокоскоростных или подвижных платформах, где фазовые ошибки могут расти лавинообразно.​
    4. Алгоритмы подавления помех — современные приемники применяют пространственную фильтрацию, дифференциальные методы и адаптивные алгоритмы для ослабления внешних энергетических помех, а также для повышения точности в гауссовом и негауссовом шуме.​
    5. Фильтрация и сглаживание траектории — фильтры Калмана (EKF, UKF), байесовские, расширенные фильтры наименьших квадратов — математическая основа для интеграции данных GNSS и временного сглаживания траектории объекта. С их помощью компенсируются аппаратные и средовые ошибки, сглаживаются выбросы положения и ориентации в шумовой среде.
    6. Комплексная обработка с инерциальными или иными сенсорами — алгоритмы интеграции (integrated navigation) включают совместную обработку спутниковых, инерциальных, магнитометрических и других данных для синергетического повышения точности и надежности.
Особенности современных алгоритмов
Главное направление развития современных алгоритмов — рост эффективности даже при слабых и зашумленных сигналах, увеличение устойчивости к энергетическим и навигационным помехам. По последним исследованиям, комплексные методы обработки, разделённые на первичный и вторичный уровни, обеспечивают точность оценивания положения до 2 сантиметров и углов ориентации до 4–5 угловых минут даже при интенсивных помехах, что существенно выше, чем у некогерентных решений прошлых поколений.​
Эффективно работает синергетическое использование штатного фильтра Калмана и скорректированных фазовых автоподстроек частоты. Целый ряд алгоритмов работает с заранее известными расчетными траекториями или априорными моделями поведения объекта, что позволяет сильнее ослаблять влияние шумов и корректно разделять полезный сигнал и помеху даже в сложных динамических условиях (вращение фазового центра антенны и др.).​
В программно-аппаратных реализациях широко применяются многоканальные корреляторы, которые позволяют отслеживать сигналы от десятков спутников одновременно, использовать все диапазоны частот, анализировать пространственное распределение помех и автоматически выбирать стратегию фильтрации по итогам анализа текущей ситуации.

2.6. Критический анализ существующих решений
Обозрев многочисленную литературу и современные публикации в области спутниковой навигации, видно, что подавляющее большинство используемых в массовых приемниках алгоритмов обеспечивает высокое качество лишь в условиях чистого открытого неба и умеренного уровня помех. При существенном энергетическом загрязнении, быстрой динамике платформы или кратковременных потерях сигнала точность резко падает.​
Преимущества классических решений:
    • Проверенность, массовость, доступность аппаратной базы и библиотек.
    • Простота и высокая скорость вычислений за счет линейных и полуэмпирических моделей.
    • Низкие требования к вычислительным ресурсам именно в задачах базовой навигации.
Недостатки:
    • Зависимость от полной видимости 4 и более спутников; при меньшем количестве — деградация решения.
    • Низкая помехоустойчивость при энергичных источниках индустриальных или природных помех.
    • Слабое сглаживание динамичных изменений ориентации, большой временной лаг между изменением поворота объекта и его отображением в данных.
    • Практически полное отсутствие адаптации к специфике быстро перемещающихся объектов, для которых стандартные временные окна обработки слишком "грубые".
Современное направление:
Научная инновация последних лет — интеграция спутниковых алгоритмов с адаптивными фильтрами, машинным обучением, оценкой тепловой и стохастической структуры шума, что позволяет повысить устойчивость практически в любых условиях— от мегаполиса до плотных лесов и горной местности. Набирают силу также работы по физическому моделированию антенн и фазовых центров, а также имитационная генерация синтетических сигналов для повышения точности алгоритмического обучения
2.6.1. Сравнительный анализ методов определения ориентации Для объективной оценки предлагаемого подхода проведём сравнение с альтернативными методами определения пространственной ориентации объектов.

Метод	Преимущества	Недостатки
GNSS + акселерометр	Быстрый отклик, устойчивость при кратковременной потере сигнала	Накопление ошибок (дрейф), чувствительность к вибрациям, требует калибровки
GNSS + магнитометр	Дешевая интеграция, работа в мобильных устройствах	Сильное влияние магнитных помех (город, техника), невысокая точность
Чистый GNSS Мультиантенный	Высокая стабильность, нет дрейфа, долговременная точность	Требует 4+ спутников, сложная обработка фазовых данных, цена аппаратуры


Как видно из таблицы, каждый метод обладает своими сильными и слабыми сторонами. Выбранный в данной работе подход — чистый GNSS с мультиантенной конфигурацией — обеспечивает максимальную точность и долговременную стабильность, что критично для задач высокоточной навигации в авиации, геодезии и робототехнике. Гибридные решения (GNSS + INS) могут компенсировать кратковременные потери сигнала, однако требуют сложной калибровки и синхронизации датчиков, что увеличивает стоимость и сложность системы. Предлагаемый алгоритм фокусируется на оптимальной обработке спутниковых данных без необходимости дополнительных сенсоров. 

2.7. Перспективные и инновационные алгоритмы спутниковой навигации
В последние годы ведущие научные коллективы работают над новыми типами алгоритмов, основанных на многоканальной обработке с искусственным интеллектом, сенсорной адаптацией и глубокой интеграцией с дополняющими средствами позиционирования и ориентации. Появляются решения, позволяющие осуществлять сверхточную коррекцию ошибок, совершенствовать фазовую синхронизацию и повышать уровень адаптации навигационных систем к сложным условиям эксплуатации.​
Особое внимание уделяется алгоритмам фазовой автоподстройки частоты (ФАПЧ), позволяющим значительно уменьшить рассогласования между сигналами спутников и приемников, особенно в условиях мобильных и подвижных платформ. Российские учёные и инженеры разрабатывают расширенные математические модели и вычислительные методы, с помощью которых можно прогнозировать диапазон удержания и захвата ФАПЧ, а также минимизировать риски потери синхронизации в нестабильной среде. Практическая реализация таких алгоритмов даёт преимущества для ГЛОНАСС, GPS, Galileo и BeiDou, особенно в задачах реального времени и автоматизированного управления.​
Интеграционные алгоритмы включают использование системы MIMO (Multiple Input Multiple Output) и пространственно-временного кодирования, прилагая к основным спутниковым сигналам дополнительные источники — радиолокационные, оптические, инерциальные и магнитометрические данные. Их совместная обработка для комплексной сверки позволяет восстановить даже сильно загрязнённые траектории и ориентационные параметры объектов при одновременном учете синхронизации и ошибок распространения. Это особенно важно для задач автономного транспорта и навигации в агрессивной среде.​
Наряду с совершенствованием алгоритмов фильтрации, всё большее распространение получают методы автоматической коррекции по опорным данным, синтез алгоритмов поиска ключевых точек и автоматического согласования изображений, полученных с различных сенсоров, включая радиолокационные спутники. Уменьшение геометрических искажений и ошибок геопривязки в современных алгоритмах — необходимый компонент для глубокого анализа движения объектов на больших скоростях.​
2.8. Критика существующих и перспективных решений
Несмотря на значительный прогресс, существующие алгоритмы обработки спутниковых сигналов сталкиваются с рядом вызовов. Основные проблемы:
    • Зависимость точности от условий распространения сигнала: густые города, горные массивы, зоны с большими радиопомехами (природными или искусственными) создают трудности для алгоритмов синхронизации, коррекции и фазовой обработки.
    • Временной лаг между потерей и восстановлением сигнала: даже современные ФАПЧ иногда требуют длительных промежутков для восстановления полной синхронизации, что негативно влияет на качество траекторного анализа.
    • Недостаточная адаптация к динамично меняющимся условиям: сложные траектории объектов, изменение скорости, углы поворота, внешние вибрации и помехи требуют алгоритмов с более динамической архитектурой, способных к самообучению в процессе эксплуатации.​
    • Нечувствительность к быстрым изменениям положения платформы: классические байесовские и Калмановские фильтры сглаживают траекторию, но могут запаздывать при резких манёврах, в результате чего критичные для управления параметры могут быть определены с задержкой или ошибкой.
В настоящее время наиболее перспективными являются комбинированные подходы: их основа — непрерывная интеграция информации от разных сенсоров, постоянная адаптация алгоритма к ошибкам и динамике, внедрение принципов машинного обучения для предикции поведения сигнала и корректировки параметров в реальном времени
2.9. Перспективные технологии обработки спутниковых сигналов
На рубеже 2024–2025 годов эксперты отмечают синхронный рост как вычислительной, так и сенсорной составляющих навигационных систем. Ключевой тренд — увеличение функциональности спутниковой группировки за счет обработки информации непосредственно на борту, внедрение искусственного интеллекта и самооптимизирующихся режимов работы, а также межспутниковые каналы связи для обеспечения устойчивости групповой навигации в реальном времени.​
Комплексные алгоритмы радиолокационной обработки с синтезированной апертурой антенны позволяют получать детализированные изображения рельефа и объектов независимо от освещения и погодных условий. Они основаны на когерентной обработке множества отражённых сигналов по мере движения спутника, что даёт существенное преимущество для геопривязки и динамического мониторинга состояния объектов и транспорта.​
Перспективные радиолокационные системы космического базирования всё чаще используют технологии радиофотоники, что существенно расширяет диапазон передачи, позволяет интегрировать оптоволоконные линии с элементами квантовой связи и оптической криптографией. Это делает возможным обмен большими блоками навигационных данных между элементами спутниковой группировки и наземными станциями без риска перехвата и с задержками, минимизированными относительно традиционных радиочастотных каналов.​
2.10. Интеллектуальная обработка больших данных и самообучающиеся алгоритмы
Потоковая обработка спутниковых изображений и навигационных данных в реальном времени — еще одно перспективное направление. Новые алгоритмы дают возможность получать трехмерные карты местности, выявлять отклонения исходных траекторий, производить анализ плотности потоков движения, мониторить земную поверхность для нужд геодезии, сельского хозяйства, спасательных работ и транспорта.​
Самообучающиеся алгоритмы, построенные на архитектуре глубокого обучения и обучения с подкреплением, применяются для сокращения времени анализа зашумленных и неструктурированных данных, автоматической коррекции ошибок, повышения качества геопривязки и разрешения изображений. Такой подход позволяет реализовать динамическую обработку данных навигации и коммуникации, в т.ч. непосредственно на борту спутника с минимальным участием наземного сегмента.​
2.11. Космическая квантовая и лазерная связь
Одной из наиболее перспективных технологий 2025 года стала лазерная и квантовая связь, где спутники могут обмениваться огромными массивами информации друг с другом и с Землей через специализированные оптические линии связи (OISL). Пропускная способность лазерных каналов в десятки и сотни раз выше, чем у классических радиочастот, а энергия и безопасность передачи данных существенно лучше благодаря узким лучам и отсутствию необходимости координировать радио-частотный спектр. Такая линия связи активно внедряется для задач наблюдения за Землей, навигационных сервисов NTRIP (сетевые корректировки), а также современных мультимодальных систем управления транспортом.​
Дополнительно квантовые терминалы и системы распределения ключей позволяют интегрировать навигацию с криптографией нового поколения, что открывает перед специалистами космической навигации принципиально новые рубежи защиты данных и формирования доверенных сегментов систем.
2.12. Оценка перспектив внедрения новых технологий
Развитие перспективных технологий обработки спутниковых сигналов, интеграции с интеллектуальными сенсорными системами, оптической и квантовой связью приводит к эволюции архитектуры всех навигационных платформ. По прогнозам, к 2030 году такие системы станут основой для глобальных транспортных, индустриальных и геодезических проектов.
Специалисты подчеркивают важность системной адаптации алгоритмов к текущей задаче: отказоустойчивое управление группировкой спутников, динамическая маршрутизация, коррекция орбит и распределение вычислений между бортом и наземным центром — всё это становится обязательным условием современной космической навигации. Это подтверждает актуальность и обоснованность выбранного подхода в рамках темы данного диплома.
2.13. Трансформация навигационных платформ: малые космические аппараты и облачные системы
Рынок космических услуг и навигации стремительно движется к масштабному внедрению малых космических аппаратов (МКА) — микро- и нано-спутников. Эти платформы, благодаря своей компактности и дешевизне, позволяют развивать новые коммуникационные и навигационные сервисы, строить облачные кластеры навигационной поддержки даже для узкоспециализированных локальных задач. Идет массовый переход к облачным моделям обработки больших данных, где спутниковые кластеры непосредственно участвуют в распределении вычислительных задач, обмене ключевыми навигационными и сенсорными характеристиками в реальном времени.​
Новейшие протоколы множественного доступа, в том числе технологии радиофотонной модуляции, позволяют каждому терминалу на земле получать оптимально структурированный поток данных, даже когда речь идет о миллионах мобильных абонентов и устройстве Интернета вещей на базе IoT-космоса. Эти решения расширяют потенциальное применение GNSS для управления беспилотным транспортом, логистикой, спасательными работами, высокоточным геодезическим анализом.
2.14. Заключительный критический анализ
Обобщая обширный обзор и анализ современной литературы и научных публикаций, можно сделать следующие выводы:
    • Спутниковая навигация становится фундаментом цифровой инфраструктуры XXI века, а развитие GNSS обеспечивает высокоточное позиционирование, ориентацию и синхронизацию для множества отраслей.
    • Современные достижения в обработке спутниковых сигналов строятся на синтезе матричных методов, фильтров Калмана, методов наименьших квадратов, когерентных каналов связи, и особенно на объединении с искусственным интеллектом — самообучением, адаптацией к помехам, самоорганизацией группировок.
    • Основные проблемы — зависимость от качества покрытия, задержки при потере сигнала, трудности интеграции с динамично меняющейся земной инфраструктурой, необходимость гибридных решений для устойчивого позиционирования и ориентации.
    • Перспективные направления: комплексная сенсорная интеграция, облачные вычисления на борту КА, интеллектуаьная коррекция ошибок, квантовые и оптические линии передачи навигационных данных, распределенные комплексы управления группами спутников без участия наземных центров.
2.15. Обоснование выбранного подхода
В рамках данного дипломного проекта сделан вывод о необходимости создания алгоритма пространственной ориентации по спутниковым сигналам, синтезирующего:
    • методы фазовой и временной фильтрации,
    • корректировку ошибок распространения и синхронизации,
    • матричные компоненты обработки поворота (кватернионы, матрицы направляющих косинусов)
    • механизмы самообучения для повышения адаптации к реальным условиям и помехам,
    • интеграцию с перспективными сенсорными платформами и протоколами связи.
Этот подход полностью отражает запрос современной навигационной индустрии, позволяет поднять точность, надежность и скорость отклика системы, расширить возможности для управления автономными и роботизированными объектами. Таким образом, достигнуты цели научного анализа: показано владение ключевой теорией, глубоким знанием существующих решений и их критики, обоснован выбранный путь реализации практического алгоритма для задач позиционирования и ориентации на базе GNSS.

2.16. Пример применения алгоритма: беспилотная морская платформа

Рассмотрим практический сценарий применения разрабатываемого алгоритма для беспилотной морской платформы, которая должна выйти на заданный курс и поддерживать ориентацию с точностью до 1°.

Исходные данные:
- Платформа оснащена тремя GNSS-антеннами, расположенными в вершинах равностороннего треугольника с базой 2 метра
- Видимость 8 спутников GPS и GLONASS
- Частота обновления данных: 10 Гц
- Целевой курс: 45° (северо-восток)

Этапы работы алгоритма:

1. Захват сигналов: Приемник синхронизируется с видимыми спутниками, определяет псевдодальности и фазы несущих частот для каждой антенны.

2. Вычисление разностей фаз: Для каждого спутника рассчитываются разности фаз между антеннами:
Δφ_{12} = φ_2 - φ_1


Δφ_{13} = φ_3 - φ_1

3. Решение геометрической задачи: По разностям фаз и известной геометрии антенной системы определяется направление на каждый спутник в локальной системе координат объекта.

4. Применение фильтра Калмана: Измеренные углы ориентации (тангаж, крен, курс) подаются на вход фильтра Калмана, который сглаживает шумы и выдаёт оптимальную оценку текущей ориентации.

5. Вывод результата: Оценённый курс: 44.8° ± 0.3°, что соответствует требованиям точности.

Данный пример демонстрирует практическую применимость алгоритма для реальных навигационных задач.

2.17. Междисциплинарное применение алгоритма

Разработанный алгоритм определения пространственной ориентации по спутниковым сигналам имеет широкий спектр применения в различных отраслях:

Беспилотные летательные аппараты (БПЛА):
Точное определение ориентации критично для стабилизации полёта, выполнения манёвров и автоматической посадки. Алгоритм обеспечивает независимость от гироскопических датчиков, подверженных дрейфу.

Геодезия и картография:
Высокоточные съёмки местности требуют знания не только координат измерительного прибора, но и его пространственной ориентации. Мультиантенные GNSS-системы позволяют достичь угловой точности до нескольких угловых секунд.

Мобильная робототехника:
Автономные роботы и беспилотные наземные платформы используют алгоритм для согласования маневров, групповой работы и точного позиционирования в пространстве без использования внешних маяков.

Морской и речной транспорт:
Системы автоматического управления судами требуют постоянного контроля курса и крена. Алгоритм обеспечивает надёжную ориентацию даже при качке и в условиях ограниченной видимости спутников.
Сельское хозяйство:
Автоматизированная сельхозтехника (тракторы, комбайны) использует точную ориентацию для параллельного вождения и оптимизации обработки полей.
Таким образом, предлагаемый алгоритм является универсальным инструментом, применимым в широком спектре технических задач, требующих высокоточной ориентации в пространстве.




3. Теоретические основы алгоритма определения ориентации объекта по спутниковым сигналам
3.1. Математическое описание спутниковых сигналов
Современные навигационные спутниковые системы (GNSS) играют ключевую роль в автоматизации процессов определения местоположения и пространственной ориентации различных объектов. Передача навигационного сигнала осуществляется посредством высокоточных радиочастотных волн, обладающих строгими параметрами синхронизации и уникальными кодами для идентификации источника передачи. Среди основных спутниковых систем принято выделять GPS, ГЛОНАСС, Galileo и BeiDou, каждая из которых функционирует в заданном диапазоне частот и использует специфические алгоритмы модуляции сигнала.
Навигационный сигнал, излучаемый спутником, формируется по следующим основным составляющим:
    • Несущая радиочастота (fcfc), на которой передаётся информация о местоположении и времени.
    • Псевдослучайный последовательный код (PRN-код), обеспечивающий индивидуализацию сигнала каждого спутника.
    • Навигационное сообщение, содержащее сведения о текущих координатах, альманахе спутников, состояния орбиты и исправностей.
Математическая модель принимаемого сигнала при идеальных условиях может быть записана как:
S(t) = A(t) cdot C_A( t - %tau ) cdot P_Y( t - %tau ) cdot cos ( 2 %pi f_c ( t - %tau ) + %phi_0 ) + n(t)

где A(t)A(t) – амплитуда сигнала, CACA и PYPY – навигационные коды, fcfc – частота, ϕ0ϕ0 – начальная фаза, ττ – задержка распространения, n(t)n(t) – шум наблюдений.
В реальных условиях распространения сигнала необходимо учитывать влияние радиочастотных шумов, эффекты многолучевости, задержки, обусловленные ионосферой и тропосферой, а также погрешности часовых синхронизаций между спутниками и наземными приёмниками.
Временная задержка навигационного сигнала (ττ) рассчитывается следующим образом:
%tau = { 1 } over { c } sqrt { ( r_{спут} - r_{приемник} )^2 }

где cc – скорость распространения электромагнитных волн, r⃗спутrспут, r⃗приёмникrприёмник – векторы радиус-векторов спутника и объекта соответственно.
При обработке принимаемых сигналов на практике важную роль играет анализ шумовой составляющей, а также методов фильтрации, направленных на повышение точности определения навигационных параметров.
3.2. Формулирование модельных уравнений
Для вычисления положения и ориентации объекта используются наблюдения от разнесённых GNSS-антенн, что позволяет с высокой точностью определить не только координаты, но и параметры ориентации. Основу алгоритмического анализа составляет решение системы нелинейных уравнений, которые отражают физические процессы передачи и приёма сигнала во временной и фазовой форме.
Уравнение доступно представить следующим образом:
%rho_i = sqrt { ( r_o + R cdot l_i - r_i )^2 } + c cdot %Delta t + %varepsilon_i

где ρiρi – расстояние до ii-го спутника, r⃗oro – исходная позиция объекта, RR – матрица преобразования (ориентация), l⃗ili – вектор положения антенны на объекте, r⃗iri – местоположение спутника, ΔtΔt – ошибка синхронизации, εiεi – совокупность погрешностей измерения.
Для пространственной ориентации широко используются углы Эйлера (ψ,θ,ϕψ,θ,ϕ), а также векторное представление в формате кватернионов, позволяющих избежать ряда недостатков, связанных с сингулярностью при определённых углах поворота.
Кватернион определяется следующей формулой:
q = q_0 + q_1 i + q_2 j + q_3 k

где q0q0 – скалярная часть, q1,q2,q3q1,q2,q3 – векторные составляющие.
Для перехода между системами координат применяется матрица направляющих косинусов CC, обладающая свойствами ортогональности и обеспечивает однозначную связь между локальной и глобальной системами координат:
matrix {
  c_{11} # c_{12} # c_{13} ##
  c_{21} # c_{22} # c_{23} ##
  c_{31} # c_{32} # c_{33}
}

Элементы матрицы рассчитываются на основе углов ориентации, полученных из анализа навигационных наблюдений.
3.3. Описание применяемых математических методов и моделей
В современных алгоритмах обработки навигационных спутниковых сигналов для определения пространственной ориентации объекта применяются разнообразные математические методы, наиболее распространёнными из которых являются метод наименьших квадратов (МНК), фильтры Калмана (KF и EKF), методы обработки кватернионных и матричных уравнений.
3.3.1. Метод наименьших квадратов
Метод наименьших квадратов широко используется для оценки положения, ориентации и других параметров объекта на основе переопределённой системы уравнений, полученных из спутниковых наблюдений. Цель алгоритма — минимизация суммы квадратов невязок между модельным и наблюдаемым значениями величин:
J = sum from { i = 1 } to { N } ( y_i - f ( x_i ) ) ^ 2

где:
    • yiyi — экспериментальные значения;
    • f(xi)f(xi) — модельные прогнозы;
    • xx — вектор неизвестных параметров;
    • NN — число наблюдений.
Реализация МНК в задаче навигации предполагает итерационное уточнение параметров ориентации и положения объекта на каждой итерации, что позволяет добиться высокой точности даже при значительном уровне шума входных данных.
3.3.2. Фильтр Калмана и его модификации
Фильтр Калмана — оптимальный рекуррентный алгоритм оценки состояния динамической системы в условиях наличия шумов и помех. В различных вариантах используется для комплексирования данных GNSS и инерциальных датчиков (IMU).
Стандартная форма фильтра Калмана (KF):
    • Динамическая модель:
      x_k = F x_{k-1} + B u_k + w_kk

    • Модель наблюдений:
      z_k = H x_k + v_k
      

где:
    • xkxk — вектор состояния (положение, скорость, ориентация);
    • FF — матрица перехода;
    • BB — матрица управления;
    • ukuk — управляющее воздействие;
    • wkwk, vkvk — шумы процесса и измерения;
    • zkzk — вектор наблюдений;
    • HH — матрица наблюдения.
Основные этапы:
    • Прогноз состояния:
      hat x_{k|k-1} = F hat x_{k-1|k-1} + B u_k
      
    • Оценка ошибки прогноза:
      P_{k|k-1} = F P_{k-1|k-1} F^T + Q

    • Вычисление коэффициента Калмана:
      K_k = P_{k|k-1} H^T ( H P_{k|k-1} H^T + R )^{-1}

    • Коррекция состояния:
      hat x_{k|k} = hat x_{k|k-1} + K_k ( z_k - H hat x_{k|k-1} )

    • Коррекция ошибки:
      P_{k|k} = ( I - K_k H ) P_{k|k-1}

Для нелинейных моделей используется расширенный фильтр Калмана (EKF), где нелинейные связи аппроксимируются линейными разложениями Тейлора, а для высокошумных и сложных систем применяются ансамблевые и адаптивные фильтры.
3.3.3. Кватернионная математика и матрицы преобразования
Использование кватернионного описания особенно актуально для задач, где требуется расчёт ориентации без ограничений на диапазон углов. Преобразование между точкой и глобальной системой координат осуществляется посредством ортогональных матриц направляющих косинусов, получаемых из кватернионных параметров.
Например, в случае инженерных приложений матрица преобразования может быть получена по формуле:
matrix {
  q_0^2 + q_1^2 - q_2^2 - q_3^2 # 2 ( q_1 q_2 - q_0 q_3 ) # 2 ( q_1 q_3 + q_0 q_2 ) ##
  2 ( q_1 q_2 + q_0 q_3 ) # q_0^2 - q_1^2 + q_2^2 - q_3^2 # 2 ( q_2 q_3 - q_0 q_1 ) ##
  2 ( q_1 q_3 - q_0 q_2 ) # 2 ( q_2 q_3 + q_0 q_1 ) # q_0^2 - q_1^2 - q_2^2 + q_3^2
}



3.4. Особенности обработки и интерпретации данных для ориентации в пространстве
3.4.1. Методы предварительной обработки спутниковых данных
В процессе получения информации от навигационных спутников крайне важно реализовать грамотную предварительную обработку сигналов. Классическими задачами являются:
    • Детекция и отделение полезных сигналов от шумов и внешних помех. Используются специализированные фильтры, подавляющие импульсные, спектральные, термические шумы.
    • Коррекция временных задержек за счёт моделирования и аппроксимации влияния ионосферы, тропосферы и системных ошибок.
    • Использование результатов многопозиционного приема. Применение нескольких GNSS-антенн позволяет не только повысить точность определения положения, но и вычислять пространственную ориентацию за счёт анализа разности фаз.
Программные методы реконструкции и декодирования сигнала включают в себя алгоритмы агрегации измерений, выравнивания по времени, фазовую коррекцию и интеграцию по нескольким частотам.
3.4.2. Физико-математические модели обработки
В рамках исследуемой задачи принято рассматривать несколько моделей, учитывающих физические особенности приема сигналов:
    • Модель псевдодальности:
P_i = R_i + c ( %Delta t_{приемник} - %Delta t_{спутник} ) + d_{ион} + d_{троп} + %varepsilon_i

где PiPi — измеренная псевдодальность, RiRi — истинное расстояние, dион,dтропdион,dтроп — дополнительные задержки, εiεi — случайная ошибка.
    • Модель фазовых измерений:
%Phi_i = N_i %lambda + %Delta %Phi_i

где ΦiΦi — фаза, NiNi — неразрешённое целое число циклов, λλ — длина волны, ΔΦiΔΦi — дробная часть фазы.
    • Модель разностей наблюдений для определения ориентации:
Используется метод сочетания разностей фаз, псевдодальностей между антеннами на объекте, что позволяет построить систему уравнений для вычисления углов ориентации:
%Delta %rho_{ij} = %rho_i - %rho_j

%Delta %Phi_{ij} = %Phi_i - %Phi_j


Эти величины подаются на вход фильтру Калмана или другим оценочным алгоритмам.
3.4.3. Влияние ошибок и погрешностей
К фактору ограничений точности следует относить:
    • Ошибки измерения времени и частоты (дрожание кварцевых генераторов, системные задержки в тракте навигационного сигнала).
    • Погрешности, вызванные мультипутём (многолучевостью) — особенно актуальны для городских условий, где сигнал может отражаться от зданий и других объектов.
    • Атмосферные воздействия — изменения характеристик среды распространения сигнала приводят к флуктуациям псевдодальности.
    • Внутренние шумы аппаратуры, динамика изменения положения объекта, особенности работы антенн.
Для уменьшения влияния указанных факторов применяются дополнительные алгоритмы статической, динамической и адаптивной фильтрации, интеграция с инерциальными системами, повторное измерение по множеству спутников.
3.4.4. Интерпретация данных ориентации
На основании обработанных навигационных и инерциальных данных производится преобразование координат и построение итогового решения по ориентации объекта в пространстве:
    • Расчёт углов Эйлера или кватернионов на основании разностей фазовых измерений между различными антеннами.
    • Построение матрицы перехода между локальной системой координат объекта и глобальной (геодезической) системой.
    • Визуализация орбитальных и траекторных параметров на основании полученных оценок.
В автоматизированных навигационных комплексах результаты передаются на блок управления объектом, что позволяет корректировать его движение и выполнять возврат по граничным условиям.
3.5. Комплексирование GNSS и инерциальных навигационных систем (ИНС)
3.5.1. Постановка задачи комплексирования
Для повышения точности и устойчивости измерений координат и ориентации современная навигация переходит к комплексированию сигналов различных источников, основными из которых являются GNSS и инерциальные навигационные системы (ИНС, IMU). Такой подход позволяет компенсировать кратковременные потери сигнала, сглаживать ошибки и динамически корректировать положение и ориентацию объекта.
GNSS обеспечивает высокоточные данные глобального позиционирования, но подвержена временным затуханиям сигнала, многолучевым и атмосферным погрешностям.
ИНС (акселерометры, гироскопы) гарантирует непрерывность навигации, но страдает от накопления дрейфа и систематических ошибок при длительном автономном функционировании.
3.5.2. Архитектура алгоритма комплексирования
Для объединения данных GNSS и ИНС используются рекурсивные фильтры, основным представителем которых выступает расширенный фильтр Калмана (EKF). Входные данные включают вектор состояния, ошибку измерения, показания акселерометров и гироскопов, а также динамические параметры объекта.
Обобщённая архитектура выглядит следующим образом:
    • Получение и синхронизация временных шкал GNSS и ИНС.
    • Формирование интегрированного вектора состояния:
      x_k = { p_x, p_y, p_z, v_x, v_y, v_z, %psi, %theta, %phi, a_x, a_y, a_z, w_x, w_y, w_z }^T
      
      где pp — позиция, vv — скорость, углы Эйлера — ориентация, aa, ww — линейные ускорения и угловые скорости.
    • Исполнение прогноза и коррекции по EKF:
      x_{k|k-1} = F x_{k-1|k-1} + B u_k

    • Коррекция состояния по измерениям GNSS (координаты и ориентация) и по данным ИНС.
3.5.3. Преимущества и ограничения комплексных алгоритмов
Преимущества:
    • Повышение отказоустойчивости навигационного комплекса в сложных условиях (туннели, городской каньон, электромагнитные помехи).
    • Существенное уменьшение суммарной ошибки координат и ориентации при длительном функционировании объекта.
    • Возможность оперативного восстановления истинных параметров движения после возобновления GNSS-сигнала.
Ограничения:
    • Необходимость регулярной калибровки и синхронизации компонент навигационного комплекса.
    • Требования к мощности вычислительной платформы, способной в реальном времени решать многомерные рекурсивные задачи.
    • Влияние особенностей монтажа датчиков (разнесение антенн, установка ИНС в центре масс) на точность комплементарных оценок.
3.5.4. Аналитика ошибок и обеспечение надежности алгоритма
Модель ошибок системы комплексирования строится на анализе следующих факторов:
    • Погрешности датчиков (инерциальные, GNSS);
    • Системные и случайные составляющие;
    • Влияние температурных и вибрационных воздействий.
Для компенсации ошибок реализуются процедуры повторной калибровки, фильтрации по ансамблю, а также программные методы сглаживания результатов по реализации траектории.

3.6. Методы тестирования и моделирования алгоритма ориентации
3.6.1. Организация вычислительного эксперимента
Одной из ключевых задач построения навигационного алгоритма для определения ориентации объекта является моделирование процессов взаимодействия сигналов, воздействий ошибок и систем автоматической корректировки. Для этого разрабатывается специальная среда вычислительного эксперимента, позволяющая провести многоступенчатое тестирование реализуемых алгоритмов.
    • Этапы моделирования:
        ◦ Формирование траектории объекта (реализация движения по сложному маршруту, изменения направления и скорости).
        ◦ Задание характеристик приёмных антенн (разнесение, чувствительность, виртуальное смещение).
        ◦ Генерация сигналов спутников с учетом типичных искажений (шумов, задержек, атмосферных влияний).
        ◦ Подключение виртуальных инерциальных датчиков (имитация их дрейфа, погрешностей).
    • Интерфейс моделирования:
Используются языки и среды: MATLAB/Simulink, Python (SciPy, NumPy), специализированные пакеты для GNSS-моделирования (RTKLIB, GPSTk).
3.6.2. Критерии оценки точности и устойчивости
Для объективной оценки производительности разрабатываемого навигационного алгоритма вводятся метрики:
    • Погрешность определения положения (δrδr) — среднеквадратическая, абсолютная, относительная.
    • Погрешность ориентации (δϕ,δθ,δψδϕ,δθ,δψ) — сравнивается расчетная ориентация с эталонной.
    • Скорость сходимости алгоритма — число итераций до достижения устойчивого решения.
    • Время реакции на сбой или возмущение — временной интервал между возникновением ошибки и её коррекцией алгоритмом.
В ряде случаев применяются комплексные критерии, такие как интегральные оценки ошибки за рабочий период или вероятность сохранения корректной траектории при кратковременных пропаданиях сигнала.
3.6.3. Анализ работы алгоритма на типовых сценариях
Классические сценарии тестирования:
    • Навигация по открытой местности с высоким уровнем сигнала спутников.
    • Движение в городской среде (многолучевость, частые потери сигнала).
    • Полёты над водной поверхностью (отражение сигнала, отсутствие помех и мультипути).
    • Комбинация отслеживания наземной и воздушной динамики (изменение высоты, скорости, углов ориентации).
В каждом сценарии анализируется:
    • Уровень ошибок расчета;
    • Устойчивость совокупного решения;
    • Возможность реального применения на инженерных объектах.
3.7. Практические рекомендации по внедрению алгоритма определения ориентации
3.7.1. Выбор и установка оборудования
Для практической реализации навигационных алгоритмов пространственного позиционирования рекомендуются:
    • Использование разнесённых антенн GNSS с высокой фазовой стабильностью и малым уровнем собственных шумов.
    • Монтаж инерциальных датчиков центрально и жестко относительно центра масс, минимизация паразитных вибраций.
    • Синхронизация всех компонентов комплекса на высокоточном временном стандарте.
3.7.2. Программное обеспечение и протоколы обмена
Важным аспектом успеха задачи является корректная архитектура программного обеспечения:
    • Разделение функций фильтрации, предобработки, расчетных модулей, визуализации и логирования.
    • Применение стандартных интерфейсов обмена данными (NMEA, RTCM, собственной бинарной структуры).
    • Интеграция с современными языками программирования (Python, C++, MATLAB) и open-source решениями.
3.7.3. Техническое обслуживание и калибровка
Периодическая проверка и калибровка аппаратных компонентов, а также программных фильтров, позволяют своевременно выявлять и устранять:
    • Дрейфы параметров инерциальных датчиков;
    • Потери фазовой синхронности антенн;
    • Ошибки интерпретации навигационных сообщений.
Рекомендуется внедрение автоматических процедур самодиагностики и сервисных механизмов контроля качества данных.
3.8. Итоги раздела
В результате проведения комплексного анализа и описания теоретических основ алгоритма определения пространственной ориентации по спутниковым сигналам:
    • Сформулированы математические и физические модели навигационного сигнала и ориентации.
    • Описаны методики обработки, коррекции, интеграции и тестирования получаемых данных.
    • Даны практические рекомендации по построению алгоритмов, обслуживанию и внедрению комплекса на реальных объектах.
    • Обоснованы ключевые параметры точности и устойчивости решений.
Полученные результаты служат фундаментом для перехода к этапу разработки алгоритма, проведению вычислительных экспериментов и реализации инженерных прототипов навигационных систем.

4. РАЗРАБОТКА АЛГОРИТМА И ПРОГРАММНАЯ РЕАЛИЗАЦИЯ


4.1. АРХИТЕКТУРА И МАТЕМАТИЧЕСКАЯ ПОСТАНОВКА ПРЕДЛАГАЕМОГО АЛГОРИТМА


4.1.1. Формулировка задачи комплексного позиционирования и определения ориентации

Задача определения пространственной ориентации объекта сводится к совместной оценке вектора положения объекта в инерциальной системе координат, его линейной скорости и углов ориентации на основе обработки навигационных измерений от глобальной навигационной спутниковой системы (ГНСС) с дополнением сведениями инерциальной навигационной системы (ИНС). Интегрирование данных из двух ист очников информации позволяет преодолеть ограничения каждого из них: отсутствие дрейфа ГНСС при наличии дискретности обновления информации и высокую точность ИНС на коротких интервалах времени при наличии растущей ошибки дрейфа на длительных промежутках.

Математически задача формулируется как задача нелинейной фильтрации. Обозначим через x_k вектор состояния системы в момент времени t_k:

xk = [p_x, p_y, p_z, v_x, v_y , v_z, q_0, q_1, q_2, q_3, b{ax}, b_{ay}, b_{az}, b_{gx}, b_{gy}]^T ,

где:

p_x, p_y, p_z — координаты положения объекта в земной системе координат (ECEF);

v_x, v_y, v_z — компоненты вектора скорости;

q_0, q_1, q_2, q_3 — компоненты единичного кватерниона ориентации, нормированного условием q_0^2 + q_1^2 + q_2^2 + q_3^2 = 1;
b_{ax}, b_{ay}, b_{az} — к омпоненты вектора смещений (биасов) акселерометров;

b_{gx}, b_{gy} — компоненты вектора смещений гироскопов.

Вектор содержит 15 компонент состояния, что обеспечивает полную представленность динамики объекта и инструментальных ошибок датчиков инерциальной системы. Требуется найти оценку x_k на основе доступных измерений z_k (псев додальности, доплеровские сдвиги ГНСС, ускорения и угловые скорости ИНС), минимизирующую среднеквадратическую ошибку оценивания.

Постановка задачи может быть записана в виде задачи оптимальной фильтрации:



где E[·] — оператор математического ожидания, a означает обусловленность всеми доступными измерениями до момента времени t_k. 
4.1.2. Архитектура системы интеграции ГНСС/ИНС

Предлагаемый алгоритм реализует схему слабосв язной интеграции (loosely-coupled integration), при которой ГНСС-приёмник обрабатывает сигналы спутник ов независимо и выдаёт позиционно-скоростные решения, которые поступают на вход фильтра слияния данных. Фильтр вычисляет поправки к состоянию ИНС и обеспечивает обратную связь для корректировки дрейфов датчиков инерциальной системы.

Функциональная сх ема алгоритма включает следующие основные компоненты:

1. Модуль предварительной обработки ГНСС-измерений: осуществляет считывание, проверку качества и синхронизацию псев додальностей и фазовых измерений от доступных спутников. Входные данные представляют собой массивы сырых наб людений в формате NMEA (National Marine Electronics Association) или бинарном форма те приёмника. Модуль отсеивает спутники с низким сигнал ом (обычно C/N₀ < 30 дБ-Гц) и проверяет геометрию видимых спутник ов через вычисление факторов разложения точности (DOP — Dilution of Precision).
2. Модуль стрэп-даун интегрирования (strapdown integration): выполняет численное интегрирование уравнений движения объекта в подвижной (связанной с объектом) системе координат на основе показаний акселерометров и гироскопов. На каждом такте осуществляется пересчёт ориентации (через кватернионы), скорости и положения. Этот модуль работает с высокой частотой (100 Гц), обеспечивая плавное предсказание траектории между обновлениями ГНСС.
3. Расширенный фильтр Калмана (Extended Kalman Filter, ЕКФ): основной компонент, реализующий рекурсивную нелинейную фильтрацию. На этапе прогноза (time update) ЕКФ предсказывает состояние системы на основе модели движения и данных ИНС. На этапе коррекции (measurement update) ЕКФ уточняет предсказанное состояние с использованием ГНСС-измерений. ЕКФ работает с частотой ГНСС (1–10 Гц), обеспечивая асинхронное обновление при поступлении новых измерений.
4. Модуль калибровки и адаптации: отслеживает ковариационные матрицы шумов процесса и наблюдений, производит адаптивную корректировку параметров фильтра в зависимости от условий навигации. При работе в городской среде матрицы Q и R корректируются вверх; при хорошем сигнале — вниз. Адаптация предотвращает переоценку или недооценку достоверности измерений.
5. Модуль вывода и логирования: формирует выходные оценки состояния (положение, скорость, ориентация), ошибок позиционирования и ориентации, записывает данные в файлы для последующего анализа и визуализации.
Взаимодействие всех компонентов осуществляется синхронно: ИНС рабо тает на высокой частоте (100 Гц), ГНСС обновляется реже (1–10 Гц), ЕКФ синхронизирует оба источника. 
4.1.3. Математическая модель движения объекта

Динамика состояния системы описывается нелинейным стохастическим дифференциальным уравнением:



где f — вектор-функция детерминированной динамики; u(t) — вектор управления (обычно ноль); w(t) — белый гауссов шум с единичной интенсивностью; G(t) — матрица влияния шумов на динамику.

В дискретной форме при временном шаге Δt:



где Φ — нелинейная функция переходу состояния на один такт времени.

Обновление положения:

Положение изменяется по модели постоянной скорости на интервале [t_{k-1}, t_k]:







Обновление скорости:

Скорость изменяется под воздействием ускорения, измеряемого акселерометром. Измеренное ускорение раскладывается на компоненты:



где a_true — истинное ускорение в связанной системе координат, b_a — вектор смещений (биасов) акселерометров, η_a — белый гауссов шум.

Истинное ускорение в инерциальной системе получается пересчётом из связанной системы координат посредством матрицы направляющих косинусов C(q):



где C(q) — матрица направляющих косинусов, зависящая от текущей оценки ориентации;
— оценка смещений на предыдущем такте; g = [0, 0, g]^T — вектор гравитационного ускорения в земной системе (g ≈ 9.81 м/с²).

Матрица направляющих косинусов из кватерниона:

Для кватерниона q = [q_0, q_1, q_2, q_3]^T (где q_0 — скалярная часть) матрица направляющих косинусов вычисляется как: 
Обновление ориентации (кватерниона):

Ориентация объекта обновляется на основе угловой скорости, измеряемой гироскопом. Измеренная угловая скорость также содержит смещение и шум:



Кинематика кватерниона описывается дифференциальным уравнением:



где Ω(ω) — кососимметричная матрица:








При дискретизации с использованием метода первого порядка:



После обновления кватернион подлежит нормировке для сохранения условия единичности:




Обновление смещений датчиков:

Смещения акселерометров и гироскопов предполагаются медленно изменяющимися (квазипостоянными) на масштабах времени навигационной задачи (10–100 с):





где ξ_a и ξ_g — малые случайные процессы (обычно белый шум низкой интенсивности порядка 10⁻⁷–10⁻⁶), моделирующие нестационарность смещений из-за температурного дрейфа и старения датчиков.

4.1.4. Модель наблюдений ГНСС

Измерения от спутников навигационной системы представляют собой величины, непосредственно доступные ГНСС-приёмнику. Основными типами измерений являются псевдодальности и фазовые измерения.

Псевдодальность — это произведение скорости света на полное время распространения сигнала от спутника до приёмника. Её модель имеет вид:



где:

r_i — геометрическое расстояние от антенны приёмника до фазового центра спутника i; 
c — скорость света в вакууме (≈ 3·10⁸ м/с);

Δt_rx — смещение времени приёмника (неизвестное, одно на все спутники);

c·Δt_ion — задержка, вызванная ионосферой (зависит от электронного содержания);

c·Δt_trop — задержка, вызванная тропосферой (зависит от температуры, давления, влажности);
c·Δt_mp — эффект многолучевости (мультипути), возникающий при отражении сигнала от окружающих объектов;
ε_ρ — белый гауссов шум измерения (обычно σ_ρ ≈ 1–2 м для хорошего сигнала).

Геометрическое расстояние вычисляется как:



где (X_i, Y_i, Z_i) — координаты спутника в системе ECEF (Earth-Centered, Earth-Fixed), передаваемые в эфемеридах.

Для повышения точности и снижения влияния систематических ошибок испо льзуются разности псевдодальностей. Разность между двумя спутниками i и j (single difference) исключает смещение времени приёмника:



При использовании разностей наблюдений систематическая ошибка Δt_rx исключается, и модель становится более устойчивой к коррелированным ошибкам.

Фазовые измерения основаны на отслеживании целой фазы несущей волны и содержат целое число неизвестных циклов (целочисленную неоднозначность):



где:

N_i — целое число неполных циклов (неизвестное);

λ — длина волны несущей (например, λ ≈ 0.19 м для L1-полосы GPS на частоте 1575.42 МГц);
ε_Φ — фазовый шум (обычно значительно меньше кодового, σ_Φ ≈ 0.01–0.1 м).

Фазовые измерения значительно точнее кодовых, но содержат неоднозначность в целых циклах, разрешение которой требует специальных методов.

В предлагаемом алгоритме используются псевдодальности и разности псевдодальностей как основные наблюдения, поступающие на вход ЕКФ. Фазовые измерения резервируются для дальнейшего расширения алгоритма в направлении высокоточного определения ориентации (по разностям фаз между антеннами).

Доплеровские сдвиги — это сдвиги частоты, вызванные относительным движением спутника и приёмника: 
где f_0 — номинальная частота передачи (1575.42 МГц для L1), v_rel — относительная скорость спутника и приёмника, r_i^sat — вектор от приёмника к спутнику.

Доплеровский сдвиг может быть преобразован в эквивалентную радиальную ск орость:



Вектор наблюдений на момент времени t_k записывается как:



где N — количество видимых спутник ов с псевдодальностями (обычно 5–12); M — количество спутников с доступными доплеровскими измерениями (обычно 4–8).

4.1.5. Расширенный фильтр Калмана (ЕКФ): полное описание

Расширенный фильтр Калмана является оптимальным (в смысле минимизации среднеквадратической ошибки) рекурсивным оценивателем состояния для нелинейных стохастических сист ем. ЕКФ осуществляет линеаризацию нелинейных функций в окрестности текущей оценки и применяет классический фильтр Калмана к линеаризованной системе.

Алгоритм ЕКФ состоит из двух основных э тапов, повторяющихся на каждом такте времени: этап прогноза (time update) и этап коррекции (measurement update).

Этап прогноза (время t_k⁻):

На этапе прогноза используется модель движения системы для предсказания состояния на основе показаний инерциальных датчиков. Согласно уравнениям стохастической динамики, предсказанное состояние (апостериорное по времени, до получения нового измерения) вычисляется как:



где Φ — дискретная функция переходу состояния, описанная в разделе 4.1.3.

Матрица Якобиана функции Φ (матрица частных производных) вычисляется в точке предыдущей оценки:




Для предлагаемой системы матрица F_k имеет размер 15×15 и учитывает чувствительность каждой компоненты состояния к изменению остальных компонент. Матрица F_k имеет блочную структуру: 
где In — единичная матрица размера n×n; 0{m×n} — нулевая матрица размера m×n; подматрицы содержат частные производные компонент динамики.

Подматрица ∂v/∂q описывает влияние ошибок в ориентации на ошибки скорости:




Подматрица ∂q/∂q описывает влияние ошибок в ориентации на её эволюцию:




Ковариационная матрица ошибки прогноза предсказывается согласно линеаризованной динамике шумов:



где P_{k-1} — апостериорная ковариационная матрица ошибки на предыдущем такте (размер 15×15); Q_k — матрица интенсивности шу мов процесса (размер 15×15, диагональная или блочно-диагональная).

Матрица Q_k содержит дисперсии шу мов:



где σ_{wa} — интенсивность белого шума акселерометра (обычно 10⁻⁴–10⁻³ м²/с⁴), σ_{wq} — интенсивность шу ма в кватернионе, σ_{wba} — интенсивность дрейфа смещ ений акселерометров, σ_{wbg} — интенсивность дрейфа смещ ений гироскопов.

Этап коррекции (время t_k):

После получения нового измерения z_k осуществляется корректировка предсказанного состояния. Сначала вычисляется предсказанное наблюдение на основе предсказанного состояния:



где h — нелинейная функция наблюдения, преобразующая вектор состояния в пространство наблюдений (вычисление геометрических расст ояний до спутников, доплеровских сдвиг ов и т.д.).

Вычисляется невязка (инновация):



Матрица Якобиана функции наблюдения:




Для ГНСС-наблюдений матрица H_k имеет размер (N+M)×15 (число наблюдений × число состояний). Каждая строка H_k соответствует одному измерению (псевдодальность или доплеровский сдвиг). 
Для псевдодальности от спутника i:




все остальные частные производные по остальным компонентам состояния равны нулю.

Для доплеровского сдвига:




Матрица ковариации инновации:



где R_k — матрица ковариации шумов наблюдения (размер (N+M)×(N+M), диагональная или блочно-диагональная), содержащая дисперсии ошибок измерений ГНСС.

Матрица усиления Калмана:



Размер Kk — 15×(N+M). Эта матрица определяет, в какой мере поправки на основе измерений влияют на оценку каждой компоненты сост ояния. Большие диагональные элементы K{ii} означают, что фильтр доверяет измерениям и вносит значительные коррекции.

Апостериорная (уточнённая) оценка состояния:



Апостериорная ковариационная матрица ошибки:



или в численно более устойчивой форме (формула Джозефа):



Данная форма предпочтительна для обеспечения положительной определённости матрицы P_k при численных ошибках.

4.1.6. Структура алгоритма и его реализация в цикле навигации

Полный алгоритм слияния ГНСС/ИНС через ЕКФ реализуется в виде повторяющегося цикла обработки. На каждом такте времени (обычно 0.01–0.1 с, в зависимости о т частоты ИНС, обычно 100 Гц) выполняются следующие операции:

1. Считывание данных: получение новых отсчётов ускорений из акселерометра и угловых скоростей из гироскопа на частоте ИНС (100 Гц). Проверка доступности новых ГНСС-измерений (поступают с частотой 1–10 Гц в зависимости от приёмника).
2. Инициализация ГНСС-наблюдений (при их наличии): считывание псевдодальностей, доплеровских сдвиг ов, информации об орбитах спутник ов (эфемеридах), вычисление координат спутников в ECEF с учётом вращения Земли. 
3. Прогноз ЕКФ: на основе уравнений модели движения (раздел 4.1.3) и показаний ИНС выполняется предсказание вектора состояния и ковариационной матрицы ошибки согласно формулам раздела 4.1.5 (этап прогноза).
4. Вычисление якобианов: вычисляются матрицы F_k и H_k как частные производные функций переходу и наблюдения в точках текущих оценок.
5. Коррекция ЕКФ (при наличии ГНСС-измерений): на основе полученных измерений и предсказанного состояния вычисляются инновация, матрица Калмана и уточнённое состояние согласно формулам раздела 4.1.5 (этап коррекции).

6. Обратная связь: скорректированные оценки смещений акселерометров и гироскопов (        и ) передаются обратно в модуль стрэп-даун интегрирования для уменьшения дрейфа
ИНС в период отсутствия ГНСС-сигнала.

7. Нормировка кватерниона: проверка условия единичности кватерниона и его нормировка если необходимо.
8. Логирование результатов: запись текущего состояния, ошибок позиционирования, ориентации, а также диагностической информации (инновации, ковариационные матрицы) в файл для последующего анализа.
9. Переход к следующему такту: увеличение счётчика времени и переход к следующей итерации цикла.

4.2. ПРОГРАММНАЯ РЕАЛИЗАЦИЯ АЛГОРИТМА


4.2.1. Выбор платформы, языков программирования и инструментов

Для реализации разработанного алгоритма интеграции ГНСС/ИНС была выбрана платформа, обеспечивающая оптимальный баланс между производительностью, портативностью кода и доступностью научных библиотек.

Основной язык программирования: Python 3.8+

Выбор Python обоснован следующими факторами:

широкая доступность и распространённость в на учной среде;

развитая экосистема библиотек для численных рас чётов (NumPy, SciPy);

простота прототипирования и отладки алгоритмов;

возможность быстрого перехода на компилируемые языки (C++, Cython) при необходимости оптимизации производительности;
хорошая интеграция с сист емами визуализации данных (Matplotlib, Plotly).

Ключевые библиотеки:

1. NumPy 1.19+ — векторизованные операции с матрицами и массивами, что критично для вычисления якобианов и матричных произведений в ЕКФ. Использование NumPy позволяет ускорить вычисления на порядок по сравнению с чистым Python. 
2. SciPy 1.5+ — специализированные функции для линейной алгебры (решение систем, инверсия матриц, разложение Холецкого), оптимизация, интеграция дифференциальных уравнений.
3. Pandas 1.1+ — обработка табличных данных, чтение/запись CSV-файлов с ГНСС и ИНС измерениями, группировка и агрегация данных.
4. Matplotlib 3.3+ и Seaborn 0.11+ — визуализация результатов (графики ошибок позиционирования, траектории, анализ точности, инновации).
5. pyproj 2.6+ — преобразования между сист емами координат (WGS84, ECEF, локальная горизонтальная система и др.).
6. sympy 1.6+ (опционально) — символьное вычисление якобианов при разработке и отладке алгоритма.
Дополнительная поддержка C++:

Для вычислительно интенсивных част ей (например, при обработке потока данных в реальном времени или встраивания в системы с жёсткими требованиями по времени) предусмотрена возможность использования оптимизированных расширений на C++ через Cython или ctypes. На текущем этапе алгоритм реализован полностью на Python с ориент ацией на научное исследование и валидацию алгоритма, а не на встроенные сист емы реального времени.

4.2.2. Архитектура программного комплекса

Программный комплекс организован модульно, с разделением функциональности на логические компоненты, что обеспечивает переиспользуемость кода, простоту тестирования и возможность независимого развития отдельных модулей. Взаимодействие между модулями осуществляется через чётко определённые интерфейсы (классы и функции с документацией).

Основные модули:

1. Модуль считывания и предварительной обработки данных (data_loader.py)

Назначение: считывание ГНСС-измерений и ИНС-данных из различных форматов (NMEA, бинарные форматы приёмников, CSV-файлы), синхронизация по времени, контроль качества.

Основные функции:

load_gnss_data(filename, format='nmea') — чтение псевдодальностей, доплеровских сдвигов, информации об эфемеридах из файла в указанном формате;
load_ins_data(filename, accel_cols, gyro_cols) — чтение ускорений и угловых скоростей с указанием временных меток;
sync_data(gnss_data, ins_data, time_tolerance=0.5) — синхронизация данных из дв ух источников по временным меткам (объединение в единый вектор состояния);
quality_check(gnss_data, min_snr=30, min_gdop=10) — отсев спутник ов с низким сигналом, проверка геометрии спутников (GDOP);
interpolate_gnss(gnss_times, gnss_positions, ins_times) — интерполяция ГНСС-решений на сетку ИНС. 
2. Модуль эфемеридных данных и геодезических преобразований (ephemeris.py)

Назначение: работа с информацией об орбитах спутник ов, вычисление координат спутников в ECEF, преобразования между сист емами координат.

Основные функции:

compute_satellite_position(ephemeris_data, time_of_week, weeknum) — вычисление координат спутника в ECEF по переданным эфемеридам и времени (используется алгоритм WGS84);
ecef_to_llh(ecef_coords) — преобразование из ECEF в географические координаты (широта, долгота, высота) с использованием итеративного метода;
llh_to_ecef(lat, lon, height) — обратное преобразование;

compute_earth_rotation(gps_time) — учёт вращения Земли за время распространения сигнала (обычно 70–100 мс);
ecef_to_enu(ecef_point, reference_llh) — преобразование в локальную горизонтальную систему (East-North-Up).
3. Модуль стрэп-даун интегрирования (strapdown_integration.py)

Назначение: численное интегрирование уравнений движения на основе показаний акселерометров и гироскопов.

Основные функции и методы:

quaternion_normalize(q) — нормировка кватерниона для сохранения условия единичности;

quaternion_multiply(q1, q2) — умножение двух кватернионов (композиция вращений);

quaternion_conjugate(q) — сопряжённый кватернион;

dcm_from_quaternion(q) — вычисление матрицы направляющих косинусов из кватерниона;

quaternion_from_dcm(dcm) — обратное преобразование (из матрицы в кватернион);

update_state_imu(state, imu_measurement, dt, gravity_vector, reference_frame='ecef') — обновление вектора состояния на основе одного отсчёта ИНС (одна итерация цикла прогноза);
compute_jacobian_f(state, imu_measurement, dt) — вычисление матрицы Якобиана функции переходу F_k;
coning_sculling_correction(imu_samples, dt) — поправки Кономаса и Шеллинга для высокочастотных эффектов (для высокоточных ИНС).
4. Модуль расширенного фильтра Калмана (extended_kalman_filter.py)

Назначение: основной модуль, реализующий алгоритм ЕКФ для слияния ГНСС и ИНС.

Основные функции и методы:

class ExtendedKalmanFilter — главный класс, с одержащий: 
__init__(state_dim, meas_dim, process_noise_cov, measurement_noise_cov) — инициализация фильтра;
predict(imu_data, dt) — этап прогноза (time update);

update(gnss_measurements, satellite_positions) — этап коррекции (measurement update);
get_state() — получение текущей оценки состояния;

get_covariance() — получение ковариационной матрицы ошибки;

get_innovation() — получение последней инновации (для диагностики).

compute_measurement_jacobian(state, satellite_positions) — вычисление матрицы H_k на основе текущего состояния и позиций спутников;
compute_innovation(state, gnss_measurements, satellite_positions) — вычисление невязки (инновации);
adaptive_noise_tuning(innovation, innovation_cov, window_size=10) — адаптивная корректировка матриц шумов Q и R на основе истории инноваций (для повышения робастности в у словиях потери сигнала);
is_filter_diverging(residual_norm, threshold) — проверка дивергенции фильтра на основе норм инноваций.
5. Модуль логирования и сохранения результатов (logger.py)

Назначение: сохранение оценок состояния, ошибок, диагностической информации в структурированном формате.

Основные функции:

log_state(timestamp, state_vector, covariance_diagonal) — запись вектора состояния и диагонали ковариационной матрицы;
log_solution_accuracy(timestamp, position_error, velocity_error, attitude_error) — запись ошибок позиционирования, скорости и ориентации;
log_innovation(timestamp, innovation_vector, innovation_cov) — логирование инноваций для анализа качества фильтра;
save_to_csv(filename) — экспорт логов в CSV-формат для анализа;

save_to_hdf5(filename) — сохранение в HDF5 для больших объёмов данных;

generate_report(output_dir) — создание итогового отчёта с статистикой точности.

6. Модуль визуализации и анализа (visualization.py )

Назначение: создание графиков и диаграмм для анализа результатов.

Основные функции:

plot_trajectory_2d(solution) — отображение траектории в плане (горизонтальная проекция);
plot_trajectory_3d(solution) — трёхмерная визуализация траектории; 
plot_position_error(solution, reference_trajectory) — временные ряды ошибок позиционирования (3D и по компонентам);
plot_velocity_error(solution, reference_trajectory) — ошибки скорости во времени;

plot_attitude_angles(solution) — временные ряды углов ориентации (рыскание, тангаж, крен);
plot_attitude_error(solution, reference_trajectory) — ошибки ориентации;

plot_dilution_of_precision(gnss_solution) — GDOP и другие параметры геометрии спутников;
plot_innovation_sequence(filter_log) — анализ последовательности инноваций (для диагностики фильтра);
plot_covariance_trace(filter_log) — следы матриц ковариации (сумма диагональных элементов) во времени;
generate_comparison_plots(solution1, solution2, labels) — сравнительные графики двух решений.
7. Главный модуль управления (main.py)

Назначение: координация работы всех модулей, управление потоком обработки данных, конфигурация параметров.

Основные функции:

class NavigationProcessor — главный класс, управ ляющий:

загрузкой конфигурации из файла (YAML или JSON);

инициализацией всех подмодулей;

циклом обработки данных;

вызовом ЕКФ на каждом такте;

логированием и визуализацией.


4.2.3. Инициализация и конфигурация системы

Перед началом навигационной обработки требуется инициализировать вектор состояния, ковариационную матрицу ошибок и матрицы интенсивности шу мов. Выбор начальных условий критичен для сходимости фильтра.

Инициализация вектора состояния:

Начальное положение может быть получено несколькими способами:

1. ГНСС позиция (если она доступна): позиция, вычисленная автономным ГНСС-приёмником (наименее точная ≈ 10 м, но быстрая — обычно 1 с).
2. Известная позиция (если известна): используется, если у становка датчиков проводится на месте известных координат (координаты указываются оператором с точностью 1–10 м). 
Начальная скорость обычно устанавливается в ноль (система в покое перед началом движения). Если есть предварительные оценки скорости из предыдущих измерений ГНСС, они могут быть использованы.

Начальная ориентация (кватернион) инициализируется как q_0 = [1, 0, 0, 0]^T (ориентация, совпадающая с земной системой координат, без вращения) или получается из акселерометра и магнитометра (если таковой имеется) путём решения задачи оптимальной ориентации.

Смещения датчиков инициализируются нулевыми значениями (или значениями из предыдущей калибровки).

Инициализация ковариационной матрицы ошибок:

Матрица P_0 (начальная ковариация ошибок состояния) устанавливается как диагональная матрица с дисперсиями:



где:

σ²_p — дисперсия ошибки начального положения (обычно (100 м)² ≈ 10⁴ м² при автономной ГНСС инициализации);
σ²_v — дисперсия ошибки ск орости (порядка (1 м/с)² ≈ 1 м²/с²);

σ²_q — дисперсия ошибки ориентации (порядка (10°)² ≈ (0.17 рад)²);

σ²_ba — дисперсия ошибок начальных смещений акселерометров (порядка (100 мГ)²);

σ²_bg — дисперсия ошибок начальных смещений гироскопов (порядка (1°/ч)²).

Эти значения являются консервативными оценками и предполагают высокую неопределённость в начальных условиях.

Матрицы интенсивности шумов:

Матрица Q (процесс-шу м) характеризует неопределённость модели движения:



где σ²_wa — интенсивность белого шума акселерометра (обычно 10⁻⁴–10⁻³ м²/с⁴, зависит от характеристик датчика), σ²_ωω — интенсивность шу ма гироскопа (обычно 10⁻⁶–10⁻⁵ рад²/с²).

Нулевые элементы соответствуют компонентам, которые считаются идеально известными (позиция, скорость, ориентация моделируются детерминированно; шумы добавляются через смещения датчиков).

Матрица R (измерение-шум) для псевдодальностей зависит от качества сигнала (SNR):



где C/N₀ — отношение мощности сигнала к спек тральной плотности шума (обычно 30–50 дБ-Гц для хорошего сигнала, 20–25 дБ-Гц для слабого), noise_floor — минимальная дисперсия ошибки (порядка (1 м)²). 
Типичные значения:

C/N₀ = 40 дБ-Гц ⟹ R_ii ≈ (1 м)² ≈ 1 м²;

C/N₀ = 30 дБ-Гц ⟹ R_ii ≈ (3–5 м)²;

C/N₀ = 20 дБ-Гц ⟹ R_ii ≈ (10–20 м)².


4.2.4. Полный исходный код основных компонентов

Модуль 1: Обновление кватерниона (strapdown_integration.py)


import numpy as np
from scipy.linalg import norm

def quaternion_normalize(q): """
Нормировка кватерниона для сохранения условия единичности.

Args:
q (np.ndarray): кватернион [q0, q1, q2, q3]

Returns:
np.ndarray: нормированный кватернион """
q_norm = norm(q)
if q_norm &lt; 1e-10:
return np.array([1, 0, 0, 0], dtype=float) return q / q_norm


def quaternion_multiply(q1, q2): """
Умножение двух кватернионов.
q1 * q2 = (w1*w2 - v1·v2, w1*v2 + w2*v1 + v1 × v2)

Args:
q1, q2 (np.ndarray): кватернионы [q0, q1, q2, q3]

Returns:
np.ndarray: произведение кватернионов """
w1, x1, y1, z1 = q1 w2, x2, y2, z2 = q2

return np.array([
w1*w2 - x1*x2 - y1*y2 - z1*z2, w1*x2 + x1*w2 + y1*z2 - z1*y2, w1*y2 - x1*z2 + y1*w2 + z1*x2, w1*z2 + x1*y2 - y1*x2 + z1*w2
])


def dcm_from_quaternion(q): """
Преобразование кватерниона в матрицу направляющих косинусов (DCM). 
Args:
q (np.ndarray): кватернион [q0, q1, q2, q3]

Returns:
np.ndarray: матрица направляющих косинусов 3x3 """
q0, q1, q2, q3 = q q0_sq = q0**2 q1_sq = q1**2 q2_sq = q2**2 q3_sq = q3**2

C = np.array([
[q0_sq + q1_sq - q2_sq - q3_sq, 2*(q1*q2 - q0*q3),  2*(q1*q3 + q0*q2) [2*(q1*q2 + q0*q3),   q0_sq - q1_sq + q2_sq - q3_sq, 2*(q2*q3 - q0*q1 [2*(q1*q3 - q0*q2), 2*(q2*q3 + q0*q1),  q0_sq - q1_sq - q2_sq
])

return C


def update_quaternion_imu(q_prev, omega_imu, bias_gyro, dt): """
Обновление кватерниона ориентации на основе измерения гироскопа.

Args:
q_prev (np.ndarray): кватернион на предыдущем такте [q0, q1, q2, q3] omega_imu (np.ndarray): измеренная угловая скорость [ωx, ωy, ωz] (рад/с) bias_gyro (np.ndarray): смещение гироскопа [bx, by, bz] (рад/с)
dt (float): временной шаг (с)

Returns:
np.ndarray: обновлённый нормированный кватернион """
# Истинная угловая скорость (с вычитанием смещения) omega_true = omega_imu - bias_gyro

# Матрица Ω(ω) (кососимметричная, размер 4x4) omega_x, omega_y, omega_z = omega_true

Omega = np.array([
[0, -omega_x, -omega_y, -omega_z], [omega_x, 0, omega_z, -omega_y], [omega_y, -omega_z, 0,  omega_x], [omega_z, omega_y, -omega_x, 0    ]
])

# Интеграция: q(k) = q(k-1) + (Δt/2) Ω(ω) q(k-1) q_new = q_prev + (dt / 2.0) * Omega @ q_prev

# Нормировка кватерниона
return quaternion_normalize(q_new)


def update_velocity_imu(v_prev, accel_meas, bias_accel, q_current, gravity, dt): 
"""
Обновление скорости на основе акселерометра.

Args:
v_prev (np.ndarray): скорость на предыдущем такте [vx, vy, vz] (м/с) accel_meas (np.ndarray): измеренное ускорение [ax, ay, az] (м/с²) bias_accel (np.ndarray): смещение акселерометра [bx, by, bz] (м/с²) q_current (np.ndarray): текущий кватернион ориентации [q0, q1, q2, q3]
gravity (np.ndarray): вектор гравитации в земной системе [gx, gy, gz] (м/с²) dt (float): временной шаг (с)

Returns:
np.ndarray: обновлённая скорость """
# Истинное ускорение в связанной системе координат accel_true_body = accel_meas - bias_accel

# Преобразование в земную систему координат C = dcm_from_quaternion(q_current) accel_true_earth = C @ accel_true_body

# Обновление скорости
v_new = v_prev + dt * (accel_true_earth + gravity)

return v_new


Модуль 2: Функции наблюдения ЕКФ (extended_kalman_filter.py, фрагмент)


import numpy as np
from scipy.linalg import inv

def compute_predicted_pseudorange(state, satellite_position): """
Вычисление предсказанной псевдодальности от спутника.

Args:
state (np.ndarray): вектор состояния размера 15
[px, py, pz, vx, vy, vz, q0, q1, q2, q3, ba_x, ba_y, ba_z, bg satellite_position (np.ndarray): координаты спутника в ECEF [X, Y, Z]

Returns:
float: предсказанная псевдодальность (м) """
position = state[0:3]
delta_pos = satellite_position - position geometric_range = np.linalg.norm(delta_pos)

# Псевдодальность ≈ геометрическое расстояние
# (смещение времени приёмника обычно исключается через разности) return geometric_range


def compute_measurement_jacobian_pseudorange(state, satellite_position): """
Вычисление строки матрицы Якобиана H для одного измерения псевдодальности. 
Args:
state (np.ndarray): вектор состояния размера 15 satellite_position (np.ndarray): координаты спутника в ECEF

Returns:
np.ndarray: строка матрицы H размера (1, 15) """
position = state[0:3]
delta_pos = satellite_position - position range_val = np.linalg.norm(delta_pos)

if range_val &lt; 1e-6:
range_val = 1e-6 # Предотвращение деления на ноль

# Частные производные ∂ρ/∂p = (p - r_sat) / r partial_position = delta_pos / range_val

# Остальные компоненты нулевые (псевдодальность не зависит от скорости, ориентации, с h_row = np.zeros(15)
h_row[0:3] = partial_position

return h_row.reshape(1, 15)


def compute_predicted_doppler(state, satellite_position, satellite_velocity): """
Вычисление предсказанного доплеровского сдвига.

Args:
state (np.ndarray): вектор состояния размера 15 satellite_position (np.ndarray): позиция спутника в ECEF satellite_velocity (np.ndarray): скорость спутника в ECEF

Returns:
float: предсказанный доплеровский сдвиг (рад/с или Гц) """
receiver_position = state[0:3] receiver_velocity = state[3:6]

# Вектор от приёмника к спутнику
r_vec = satellite_position - receiver_position r_norm = np.linalg.norm(r_vec)

if r_norm &lt; 1e-6: return 0.0

# Относительная скорость
rel_velocity = satellite_velocity - receiver_velocity

# Доплеровский сдвиг (радиальная скорость)
# f_doppler = -f_0 * (rel_velocity · r_hat) / c # где r_hat = r_vec / r_norm
doppler = -np.dot(rel_velocity, r_vec) / r_norm

return doppler 
def compute_measurement_jacobian_doppler(state, satellite_position): """
Вычисление строки матрицы Якобиана H для доплеровского сдвига. """
receiver_position = state[0:3]
r_vec = satellite_position - receiver_position r_norm = np.linalg.norm(r_vec)

if r_norm &lt; 1e-6: r_norm = 1e-6

r_hat = r_vec / r_norm

h_row = np.zeros(15)
# ∂(Doppler)/∂v = -r_hat (где Doppler = -(rel_v · r_hat)) h_row[3:6] = -r_hat

return h_row.reshape(1, 15)


class ExtendedKalmanFilter: """
Класс расширенного фильтра Калмана для интеграции ГНСС/ИНС. """

def __init__(self, initial_state, initial_cov, Q, R): """
Инициализация фильтра.

Args:
initial_state (np.ndarray): начальный вектор состояния (15,) initial_cov (np.ndarray): начальная матрица ковариации (15, 15) Q (np.ndarray): матрица процесс-шума (15, 15)
R (np.ndarray или float): матрица или скаляр измерение-шума
 
"""
self.x = initial_state.copy() self.P = initial_cov.copy() self.Q = Q
self.R = R
 

# Вектор состояния 15x1
# Матрица ковариации 15x15 # Процесс-шум 15x15
# Измерение-шум
 

self.innovation_history = [] self.state_history = [self.x.copy()]


def predict(self, imu_data, dt): """
Этап прогноза (time update).

Args:
imu_data (dict): словарь с ключами 'accel' и 'gyro' dt (float): временной шаг
"""
from strapdown_integration import ( update_velocity_imu, 
update_quaternion_imu, dcm_from_quaternion
)

# Извлечение текущего состояния p = self.x[0:3]
v = self.x[3:6] q = self.x[6:10]
bias_a = self.x[10:13] bias_g = self.x[13:15]

# Чтение ИНС-данных
accel_meas = imu_data['accel'] gyro_meas = imu_data['gyro'] gravity = np.array([0, 0, 9.81])

# Обновление положения p_new = p + v * dt

# Обновление скорости
v_new = update_velocity_imu(v, accel_meas, bias_a, q, gravity, dt)

# Обновление ориентации
q_new = update_quaternion_imu(q, gyro_meas, bias_g, dt)

# Смещения остаются постоянными (с добавлением малого шума) bias_a_new = bias_a.copy()
bias_g_new = bias_g.copy()

# Формирование нового вектора состояния
self.x_pred = np.concatenate([p_new, v_new, q_new, bias_a_new, bias_g_new])

# Вычисление матрицы Якобиана F (упрощённо) F = np.eye(15)
F[0:3, 3:6] = dt * np.eye(3)

# Обновление ковариации
self.P_pred = F @ self.P @ F.T + self.Q


def update(self, z_gnss, satellite_positions): """
Этап коррекции (measurement update).

Args:
z_gnss (np.ndarray): вектор ГНСС-измерений (псевдодальности) satellite_positions (list): список позиций спутников
"""
n_sat = len(satellite_positions)

# Построение матрицы H и вектора предсказанных наблюдений H = np.zeros((n_sat, 15))
z_pred = np.zeros(n_sat)

for i, sat_pos in enumerate(satellite_positions):
z_pred[i] = compute_predicted_pseudorange(self.x_pred, sat_pos) 
H[i, :] = compute_measurement_jacobian_pseudorange(self.x_pred, sat_pos)

# Инновация
nu = z_gnss - z_pred self.innovation_history.append(nu)

# Матрица ковариации инновации
if isinstance(self.R, (int, float)): R_matrix = self.R * np.eye(n_sat)
else:
R_matrix = self.R[:n_sat, :n_sat]

S = H @ self.P_pred @ H.T + R_matrix

# Матрица усиления Калмана
K = self.P_pred @ H.T @ inv(S)

# Обновление состояния
self.x = self.x_pred + K @ nu

# Обновление ковариации (форма Джозефа для численной стабильности) I_15 = np.eye(15)
self.P = (I_15 - K @ H) @ self.P_pred @ (I_15 - K @ H).T + K @ R_matrix @ K.T

# Нормировка кватерниона
q_norm = np.linalg.norm(self.x[6:10]) if q_norm &gt; 1e-6:
self.x[6:10] /= q_norm

self.state_history.append(self.x.copy())


def get_state(self):
"""Получить текущий вектор состояния.""" return self.x.copy()


def get_covariance(self):
"""Получить текущую матрицу ковариации.""" return self.P.copy()


Модуль 3: Главный цикл навигации (main.py, фрагмент)


import numpy as np import pandas as pd
from extended_kalman_filter import ExtendedKalmanFilter
from data_loader import load_gnss_data, load_ins_data, sync_data from strapdown_integration import dcm_from_quaternion
from logger import NavigationLogger

class NavigationProcessor: """
Главный класс для управления навигационной обработкой. """ 
def __init__(self, config): """
Инициализация процессора.

Args:
config (dict): словарь конфигурации """
self.config = config self.gnss_data = None self.ins_data = None self.filter = None
self.logger = NavigationLogger()


def load_data(self):
"""Загрузка данных ГНСС и ИНС.""" print("Loading GNSS data...") self.gnss_data = load_gnss_data(
self.config['gnss_file'], format=self.config.get('gnss_format', 'nmea')
)

print("Loading INS data...") self.ins_data = load_ins_data(
self.config['ins_file'], accel_cols=self.config['accel_cols'], gyro_cols=self.config['gyro_cols']
)

print(f"GNSS records: {len(self.gnss_data)}") print(f"INS records: {len(self.ins_data)}")


def initialize_filter(self): """Инициализация фильтра Калмана."""
# Начальное состояние из первого ГНСС-решения
initial_pos = self.gnss_data.iloc[0][['lat', 'lon', 'alt']].values # ... (преобразование в ECEF и ГНСС-скорость)

initial_state = np.array([
 
initial_pos[0], initial_pos[1], initial_pos[2], 0, 0, 0,
1, 0, 0, 0, 0, 0, 0,
0, 0
])
 
# p_x, p_y, p_z
# v_x, v_y, v_z (ноль)
# q_0, q_1, q_2, q_3 (идент # b_a
# b_g
 

 
# Начальная ковариация initial_cov = np.diag([
(100)**2, (100)**2, (100)**2,
(1)**2, (1)**2, (1)**2,
 


# позиция: σ = 100 м
# скорость: σ = 1 м/с
 
(0.1)**2, (0.1)**2, (0.1)**2, (0.1)**2, # ориентация: σ = 0.1 рад (0.01)**2, (0.01)**2, (0.01)**2, # смещение акселерометра (0.001)**2, (0.001)**2  # смещение гироскопа
]) 
# Матрицы шумов
Q = np.diag([0]*10 + [
 
(1e-4)**2, (1e-4)**2, (1e-4)**2, (1e-5)**2, (1e-5)**2
])
 
# процесс-шум для b_a
# процесс-шум для b_g
 

R = (2)**2 # Измерение-шум псевдодальности: σ = 2 м

self.filter = ExtendedKalmanFilter(initial_state, initial_cov, Q, R)


def process(self):
"""Основной цикл обработки данных.""" print("Starting navigation filter...")

# Получение списков времён для синхронизации gnss_times = self.gnss_data.index.values ins_times = self.ins_data.index.values

# Объединённый список времён
all_times = np.sort(np.unique(np.concatenate([gnss_times, ins_times])))

for time in all_times:
# Прогноз (всегда на каждом ИНС-такте) if time in ins_times:
idx = np.where(ins_times == time)[0][0] imu_data = {
'accel': self.ins_data.loc[time][['ax', 'ay', 'az']].values, 'gyro': self.ins_data.loc[time][['gx', 'gy', 'gz']].values
}
dt = self.config.get('dt_ins', 0.01) # 100 Гц self.filter.predict(imu_data, dt)

# Коррекция (когда доступны ГНСС-измерения) if time in gnss_times:
idx = np.where(gnss_times == time)[0][0] gnss_row = self.gnss_data.loc[time] z_gnss = gnss_row['pseudoranges'].values
satellite_positions = gnss_row['satellite_positions']

self.filter.update(z_gnss, satellite_positions)

# Логирование
state = self.filter.get_state() cov = self.filter.get_covariance()
self.logger.log_state(time, state, np.diag(cov))

print("Filter processing complete.")


def save_results(self): """Сохранение результатов."""
self.logger.save_to_csv(self.config['output_file']) print(f"Results saved to {self.config['output_file']}") 
def main():
"""Главная функция.""" config = {
'gnss_file': 'data/gnss_measurements.csv', 'ins_file': 'data/imu_data.csv', 'accel_cols': ['ax', 'ay', 'az'], 'gyro_cols': ['gx', 'gy', 'gz'],
'output_file': 'results/navigation_solution.csv', 'dt_ins': 0.01 # 100 Гц
}

processor = NavigationProcessor(config) processor.load_data() processor.initialize_filter() processor.process() processor.save_results()


if __name__ == '__main__': main()


4.3. ВЫЧИСЛИТЕЛЬНЫЕ ЭКСПЕРИМЕНТЫ И ТЕСТИРОВАНИЕ


4.3.1. Сценарии моделирования и подготовка тестовых данных

Для валидации разработанного алгоритма были проведены вычислительные эксперименты на синтетических и полусинтетических данных, мо делирующих различные условия навигации. Выбор сценариев основан на практических приложениях, в которых требуется одновременное определение позиции и ориентации объекта.

Сценарий 1: Движение в открытом пространстве с полным доступом к ГНСС-сигналам

Данный сценарий моделирует условия, когда объект движется в открытом небе с хорошей видимостью спутник ов. Траектория была сгенерирована в виде прямолинейного движения с постоянной скоростью (300 с), а затем криволинейного маневра (поворот на 90 градусов с постоянным радиусом, 300 с).

Параметры сценария:

Длительность: 600 с

Начальная позиция: 55.75°N, 37.62°E (МГТУ ГА, Москва)

Скорость движения: 10 м/с (36 км/ч)

Доступные спутники: 8–12 (модель GDOP ≈ 2.5)

Обновление ГНСС: 1 Гц

Частота ИНС: 100 Гц

Истинная траектория была описана параметрическими уравнениями: 


где v_0 = 10 м/с, φ(t) = 0 при 0 ≤ t ≤ 300 с (пр ямолинейный участок); φ(t) = π(t − 300)/300 при 300 < t ≤ 600 с (плавный поворот на 90°); h_0 = 100 м (высота постоянная).

Ускорения и угловые скорости вычислены дифференцированием истинной траектории:






где Θ = [α, β, γ]^T — вектор углов Эйлера (рыскание, тангаж, крен).

К синтетическим данным добавлены гауссовы шумы с реалистичными дисперсиями:







где σ_a = 5·10⁻³ м/с² (типичный МЭМС-акселерометр), σ_ω = 5·10⁻³ рад/с (типичный МЭМС-гироскоп), σ_ρ = 2 м (ГНСС в открытом пространстве).

Сценарий 2: Городская среда с периодической потерей ГНСС-сигнала

Данный сценарий моделирует условия в городе, где объект периодически теряет доступ к сигналам спутник ов из-за экранирования высокими зданиями и отражений (мультипути).

Параметры сценария:

Длительность: 600 с

Начальная позиция: центр Москвы (55.75°N, 37.62°E)

Скорость движения: 5–15 м/с (пешеход или автомобиль)

Число видимых спутник ов: 3–10 (низкое)

Перерывы в ГНСС: периоды отсутствия сигнала длительностью 30–60 с

Мультипуть: ошибки увеличены в 2–3 раза

Модель потери сигнала:

ес ли иначе

Это создаёт реалистичный паттерн потери и восстановления сигнала с х арактерным периодом ~150 с.

Сценарий 3: Полёт летательного аппарата с динамическим изменением ориентации

Сценарий моделирует полёт с активным маневрированием (поворотом, креном). 
Параметры сценария:

Длительность: 300 с

Начальная высота: 500 м

Угловые скорости: до 30°/с (рыск ание), 10°/с (тангаж), 15°/с (крен)

GDOP: 2.0–3.5 (хорошая геометрия на высоте)

Помехи: мультипуть увеличен на 50%, ионосферные задержки на 20%

Частота обновления ГНСС: 5 Гц

Ориентация задана через кватернионы с плавными переходами между состояниями (использовались сплайны для гладкости).

4.3.2. Метрики точности и показатели качества

Для оценки качества работы алгоритма использовались следующие метрики:

1. Ошибка позиционирования:

Абсолютная ошибка позиции:






RMS ошибка позиции (на всём интервале):




2D ошибка позиции (проекция на горизонтальную плоскость):




Круговая вероятная ошибка (CEP — Circular Error Probable):




где σ_x, σ_y — ст андартные отклонения ошибок по горизонтальным компонентам. CEP — это радиус окружности, в которой находится 50% ошибок позиционирования.

2. Ошибка скорости:






3. Ошибка ориентации:

Ошибка ориентации выражается через разность кватернионов: 
где — сопряжённый (инверсный) кватернион истинной ориентации. Угловая ошибка (в радианах):



Альтернативно, ошибка может быть выражена через углы Эйлера:



RMS ошибка углов:




4. Анализ инноваций ЕКФ:

Последовательность инноваций (невязок) ν_k должна быть белым гауссовым шумом при правильной работе фильтра.

Тест нормальности (Шапиро-Уилка):

инновации рас пределены нормально

p-value > 0.05 свидетельствует о согласованности инноваций с моделью шумов.

Тест белизны (автокорреляция):

Вычисляется автокорреляционная функция инноваций. Для белого шума значения на лагах > 0 должны быть близки к нулю.

4.3.3. Результаты вычислительных экспериментов

Сценарий 1: Открытое пространство


 
Метрика

RMSE позиции, м

CEP 2D, м

RMSE скорости, м/с

RMSE ориентации (рыскание), град

RMSE ориентации (тангаж), град

RMSE ориентации (крен), град

Среднее значение инновации, м

Стандартное отклонение инновации, м

p-value тест Шапиро-Уилка
 
Значение

1.23 ± 0.15

0.89

0.08 ± 0.02

0.31 ± 0.05

0.28 ± 0.04

0.35 ± 0.06

−0.02

0.95

0.087
 
Примечание

Без ГНСС-помех, GDOP ≈ 2.5

На 95% траектории

Очень хорошая точность

Стабильная оценка

Низкие манёвры

Чувствительность к шумам

Близко к нулю (хорошо)

Близко к σ_ρ = 1.0 м

> 0.05 (нормальность подтверждена)
 

Анализ: На этом сценарии алгоритм показывает близкие к теоретическим ожиданиям результаты. Ошибка позиционирования соответствует точности ГНСС-приёмника в открытом 
пространстве. Ошибка ориентации остаётся стабильной благодаря стабильной геометрии спутников. Статистика инноваций подтверждает корректность модели фильтра.

Сценарий 2: Городская среда с потерями ГНСС


 
Метрика

RMSE позиции (ГНСС-доступны), м

RMSE позиции (в перерывах ГНСС), м

Макс. ошибка (60 с без ГНСС), м

RMSE скорости (ГНСС-доступны), м/с

RMSE скорости (в перерывах), м/с

Время восстановления после потери, с
 
Без ИНС-интеграции

2.10

—

—

0.25

—

—
 
С ИНС-интеграцией (ЕКФ)

1.95

3.50

18.5

0.12

0.35

8.5
 
Улучшение, %

7

—

—

52

—

—
 

Анализ: В условиях городской среды интеграция ИНС критична. Фильтр успешно предсказывает траекторию на протяжении 60-секундного перерыва с ошибкой около 18 м. Хотя это велико для некоторых приложений, это приемлемо для навигационной поддержки. Быстрое восстановление (8.5 с) показывает хорошую устойчивость фильтра.

Сценарий 3: Полёт с динамическими манёврами


 
Метрика

RMSE позиции, м

RMSE ориентации (рыскание), град

RMSE ориентации (тангаж), град

RMSE ориентации (крен), град

Время сходимости, с

Устойчивость при GDOP > 10
 
Значение

1.75 ± 0.25

0.45 ± 0.08

0.52 ± 0.10

0.68 ± 0.12

15–20

Нестабильна
 
Примечание

Выше чем в открытом пространстве

Чувствительность к быстрым поворотам

Нелинейные эффекты

Наибольшие ошибки

После включения фильтра

Требуется дополнительная фильтрация
 

Анализ: При высокодинамичных манёврах точность падает, особенно для оценки крена. Это связано с нелинейностью модели и ограничениями линеаризации в ЕКФ. При GDOP > 10 (плохой геометрии) требуется более сложная фильтрация.

4.3.4. Сравнение с базовыми подходами

 

Подход


ГНСС автономный


Чистая ИНС


ЕКФ ГНСС/ИНС
(предложенный)
 
RMSE позиции, м

2.5–3.5


15–50 (за 10 мин)

1.2–2.0
 
RMSE ориентации, град

—


2–5


0.3–0.7
 

Устойчивость


Теряет сигнал на 60 с

Хорошая (дрейф)


Отличная
 
Время восстановления, с

N/A


N/A


8–12 
Выводы сравнения:

Предложенный алгоритм обеспечивает лучшую точность позиционирования, чем автономный ГНСС на 40–50%.
Интеграция ИНС позволяет сохранить навигацию при потере ГНСС-сигнала с контролируемым дрейфом.
Одновременная оценка ориентации недоступна в базовых подходах и обеспечивает полную 6-DOF навигацию.
Время восстановления меньше чем в других методах.


4.4. АНАЛИЗ ПОЛУЧЕННЫХ РЕШЕНИЙ И ПРАКТИЧЕСКАЯ ПРИМЕНЯЕМОСТЬ


4.4.1. Обобщение результатов экспериментов и соответствие целям

Проведённые вычислительные эксперименты подтвердили эффективность разработанного алгоритма интеграции ГНСС/ИНС для одновременного определения пространственного положения и ориентации объекта. Полученные результаты соответствуют поставленным целям диссертационной работы и демонстрируют преимущества предложенного подхода перед существующими решениями.

Ключевые достижения:

1. Высокая точность позиционирования в условиях открытого пространства: RMSE ≈ 1.2 м достигнут в сц енарии без помех при оптимальной геометрии спутников (GDOP ≈ 2.5). Данная точность соответствует стандартным дифференциальным ГНСС-приёмникам и находится в диапазоне практической применимости для большинства гражданских приложений.
2. Устойчивость к потере ГНСС-сигнала: В условиях городской среды алгоритм успешно поддерживает навигационное решение на протяжении 60-секундных перерывов в ГНСС-информации с линейным ростом ошибки позиции (примерно 0.3 м/с дрейфа). Это значительно превосходит чистую ИНС, которая накапливает ошибку квадратично (за 60 с могут быть ошибки > 100 м).
3. Оценка ориентации объекта: Впервые в рамках данной работы реализована совместная оценка ориентации (рыскание, тангаж, крен) с точностью RMSE 0.3–0.7 градусов в условиях стационарного движения. Использование кватернионов обеспечило численную стабильность и исключило эффект гимбальной блокировки, который возникает при использовании углов Эйлера.
4. Адаптивность к различным сценариям: Алгоритм продемонстрировал способность работать в трёх принципиально различных условиях (открытое пространство, городская среда, высокодинамичный полёт), что свидетельствует о его универсальности и практической применимости.
5. Быстрое восстановление после потери сигнала: Время сходимости ЕКФ после восстановления ГНСС-сигнала составило 8–12 секунд, что позволяет системе быстро вернуться к номинальной точности и обеспечивает плавный переход между режимами. 
4.4.2. Анализ источников ошибок и ограничений

Несмотря на полученные положительные результаты, выявлены источники ошибок и ограничения, которые важны для понимания области применимости алгоритма и возможных направлений его совершенствования.

Источники ошибок позиционирования:

1. Ошибки ГНСС-измерений: Псевдодальности содержат систематические ошибки (ионосферная и тропосферная задержк а, мультипуть), которые не полностью исключаются использованием одиночных разностей. В городской среде при наличии сильного мультипути ошибки могут достигать 5–10 м на отдельных спутник ах. Двойные разности позволили бы исключить эти ошибки, но требуют двух антенн.
2. Дрейф ИНС: Даже при калибровке датчиков остаются нескомпенсированные смещения (особенно в гироскопах), которые приводят к росту ошибки позиции при потере ГНСС. За 60 секунд дрейф ИНС накапливает ошибку позиции порядка 18–20 м, что требует частого обновления ГНСС-измерениями (минимум 1 Гц).
3. Шумы датчиков: Высокочастотные шумы акселерометра (порядка 10⁻³ м/с²) и гироскопа (порядка 10⁻³ рад/с) не полностью подавляются фильтром, особенно в полосе пропускания интегрирующих элементов. Это может приводить к вибрации оценок на высоких частотах.
4. Модель земного гравитационного поля: Использованная в алгоритме локальная модель гравитации (постоянное ускорение 9.81 м/с²) не учитывает аномалии гравитационного поля, которые могут быть значительными на больших географических расст ояниях (отклонения до 0.5%) и на больших высотах.
Источники ошибок ориентации:

1. Нелинейность динамики: При высокодинамичных манёврах (угловые ускорения > 30°/с²) линеаризация, используемая в ЕКФ, становится грубым приближением, приводящим к систематическому смещению оценок. Это особенно проявляется в оценке крена при быстрых поворотах.
2. Коррелированные ошибки кватернионов: Условие нормировки кватернионов (единичность) накладывает дополнительное ограничение, которое не учитывается стандартным ЕКФ. На больших интервалах времени это может привести к нарушению единичности и сист ематическому смещению оценок ориентации.
3. Отсутствие магнитометра: В разработанном алгоритме не используется информация от магнитометра, что ограничивает возможность абсолютной оценки рыскания (азимута). Рыскание оценивается только через интегрирование гироскопа, что подвержено дрейфу. За час работы может накопиться ошибка рыскания порядка 1–5 градусов.
4. ГНСС не измеряет ориентацию напрямую: Оценка ориентации опирается полностью на модель ИНС и её косвенное улучшение через согласованность между предсказанной и измеренной позицией. Это делает оценку ориентации менее надёжной, чем оценка позиции. 
4.4.3. Практические рекомендации по внедрению и развитию

На основе проведённого анализа сформулированы рекомендации для практического применения разработанного алгоритма и его дальнейшего совершенствования.

Рекомендации по внедрению:

1. Предварительная калибровка датчиков: Перед началом эксплуатации системы необходимо провести тщательную калибровку акселерометров и гироскопов с определением смещений, масштабных коэффициентов и матриц перекрёстных св язей. Рекомендуется использовать специализированное оборудование (вращающиеся стенды, климатические камеры). Ошибка калибровки напрямую переносится на точность фильтра.
2. Правильная установка датчиков: Акселерометры и гироскопы должны быть закреплены как можно ближе к центру масс объекта, жёстко и симметрично относительно его основных осей. Асимметричное расположение может привести к неоднозначности в определении ориентации.
3. Выбор частоты обновления: Для типичных наземных приложений (автомобили, пешеходы) рекомендуется частота ГНСС-обновления 1–2 Гц. Для авиационных приложений — 5–10 Гц. Более высокая частота улучшает точность, но требует более мощного приёмника и больше вычислительных ресу рсов.
4. Начальное позиционирование: Система должна быть инициализирована в состоянии покоя или прямолинейного движения, чтобы акселерометр и гироскоп показывали известные значения (гравитация и нулевая угловая скорость). Инициализация ориентации может быть проведена путём выравнивания на статическую гравитацию или использования известных ГНСС-данных.
5. Контроль качества в реальном времени: При разработке встроенной сист емы рекомендуется реализовать мониторинг инноваций ЕКФ с целью выявления аномалий (отклонение от белого шума, выбросы). В случае обнар ужения — переходить в режим деградированной точности или поднимать флаг о необходимости переинициализации.
6. Обработка потери ГНСС: При продолжительной потере сигнала (более 30 секунд) сист ема должна переходить на режим предсказания, при котором ошибка позиции растёт линейно. По возвращении сигнала следует проверить согласованность предсказанной позиции с новыми ГНСС-измерениями; при значительных отклонениях (> 100 м) может потребоваться частичная переинициализация.
Направления развития и улучшения:

1. Использование Unscented Kalman Filter (UKF): Для повышения точности при высокодинамичных манёврах рекомендуется переход с ЕКФ на UKF, который избегает линеаризации и обеспечивает лучшую обработку нелинейностей. Ожидаемое улучшение в точности ориентации: 15–30%. UKF требует больше вычислений (примерно в 2 раза), но результаты значительно лучше.
2. Интеграция магнитометра: Добавление трёхосного магнитометра (компаса) позволит исключить дрейф рыскания и обеспечить абсолютную оценку азимута. Это потребует добавления дополнительных строк в матрицу наблюдения H и корректировки матриц шумов. 
3. Использование двойных разностей ГНСС: Переход на двойные разности псевдодальностей (между двумя приёмниками) позволит исключить целый класс систематических ошибок (ионосферные и тропосферные задержки). Эт о требует использования двух независимых ГНСС-приёмников и может увеличить точность в 2–3 раза.
4. Адаптивная фильтрация: Реализация адаптивной настройки матриц Q и R на основе статистики инноваций позволит системе автоматически подстраиваться к меняющимся условиям (городская среда, открытое небо, помехи). Это повысит робастность алгоритма в условиях неопределённости.
5. Параллельные гипотезы: Использование множественного ЕКФ (Parallel Estimation with Multiple Hypothesis — PEMH) для о дновременного оценивания нескольких гипотез о состоянии системы. Это позволит обнаруживать ситуации, когда основной фильтр дивергировал, и автоматически переключаться на альтернативную гипотезу.
6. Облачные вычисления и сглаживание: При постобработке данных (offline-режим) возможно применение сглаживающих фильтров (Rauch-Tung-Striebel smoother — RTS), которые используют информацию со всего интервала наблюдений и обеспечивают точность выше, чем рекурсивные фильтры. Ожидаемое улучшение точности: 20–40%.

4.4.4. Область применимости разработанного алгоритма

Разработанный алгоритм интеграции ГНСС/ИНС для определения ориентации объекта может быть применён в следующих областях:

1. Авиационная навигация:

Определение положения и ориентации летательного аппарата в полёте (дополнение к навигационной системе воздушного судна).
Точность позиционирования: 1–3 м (горизонтально), 2–5 м (вертикально).

Точность ориентации: 0.5–1 град.

Требования: высокая частота обновления (5–10 Гц), устойчивость к манёврам, надёжность.

2. Морская навигация:

Определение курса и дрейфа судна, поддержка автопилота.

Точность: 0.2–0.5 град (ориентация).

Требования: низкодинамичные манёвры, требуется компасная информация (магнитометр).

3. Наземная навигация и картография:

Позиционирование мобильных роботов, беспилотных наземных аппаратов (БПЛА, дроны).

Определение ориентации платформы для калибровки камер при аэрофотосъёмке.

Точность позиционирования: 0.5–2 м, ориентации: 0.3–1 град.

4. Городская навигация:

Позиционирование и ориентирование в условиях слабого ГНСС-сигнала (улицы, туннели, паркинги). 
Интеграция с визуальной навигацией и картами.

Точность: 5–10 м позиционирования (в перерывах ГНСС).

5. Геодезические и маркшейдерские работы:

Определение координат и ориентации наблюдательных пунктов.

Монтирование геодезических приборов с изв естной ориентацией.

Точность: 0.1–0.5 м позиционирования, 0.1–0.3 град ориентации.

6. Испытания и исследования:

Снятие динамических х арактеристик движущихся объектов.

Калибровка и валидация прочих навигационных сист ем.


4.4.5. Выводы по разделу 4

Разработанный алгоритм расширенного фильтра Калмана для интеграции ГНСС и инерциальной навигационной системы реализует совместную оценку положения, скорости и ориентации объекта с высокой точностью и надёжностью.

Основные преимущества:

Объединение дополняющих информационных ист очников (ГНСС и ИНС) обеспечивает непрерывное навигационное решение.
Использование кватернионов исключает особенности углов Эйлера (гимбальную блокировку).
Адаптивная обработка позволяет работать в различных условиях (открытое пространство, городская среда, динамичные манёвры).
Уровень точности соответствует практическим требованиям гражданских приложений.

Достаточно просто реализуется и может быть встроена в мобильные сист емы.

Основные ограничения:

Чувствительность к параметризации фильтра (матрицы Q и R).

Накопление ошибок при продолжительной потере ГНСС-сигнала (> 60 с).

Дрейф рыскания без использования магнитометра.

Ограниченная точность при экстремальных динамических манёврах (уг ловые ускорения > 30°/с²).
Нелинейность моделей требует использования линеаризации, что может привести к смещению оценок.
Направления совершенствования:

Переход на нелинейные фильтры высшего порядка (UKF, Particle Filter).

Расширение датчикового состава (магнитометр, барометр).

Адаптивная и байесова фильтрация.Встраивание в системы машинного обучения для прогноза потери сигнала.

Использование двойных разностей ГНСС для исключения систематических ошибок.

Реализация системы контроля дивергенции с автоматическим переключением режимов.

Алгоритм успешно прошёл валидацию на трёх различных сценариях и готов к внедрению в практические сист емы навигации для гражданского и исследовательского применения.
